{"version":3,"sources":["webpack:///./node_modules/d3-cloud/node_modules/d3-dispatch/src/dispatch.js","webpack:///./node_modules/d3-cloud/index.js","webpack:///./node_modules/d3-array/src/ticks.js","webpack:///./node_modules/d3-array/src/ascending.js","webpack:///./node_modules/d3-array/src/bisector.js","webpack:///./node_modules/d3-array/src/number.js","webpack:///./node_modules/d3-array/src/bisect.js","webpack:///./node_modules/d3-interpolate/src/round.js","webpack:///./node_modules/d3-scale/src/constant.js","webpack:///./node_modules/d3-scale/src/number.js","webpack:///./node_modules/d3-scale/src/continuous.js","webpack:///./node_modules/d3-scale/src/init.js","webpack:///./node_modules/d3-format/src/formatSpecifier.js","webpack:///./node_modules/d3-format/src/formatDecimal.js","webpack:///./node_modules/d3-format/src/exponent.js","webpack:///./node_modules/d3-format/src/formatPrefixAuto.js","webpack:///./node_modules/d3-format/src/defaultLocale.js","webpack:///./node_modules/d3-format/src/precisionPrefix.js","webpack:///./node_modules/d3-format/src/formatGroup.js","webpack:///./node_modules/d3-format/src/formatNumerals.js","webpack:///./node_modules/d3-format/src/formatTrim.js","webpack:///./node_modules/d3-format/src/formatRounded.js","webpack:///./node_modules/d3-format/src/formatTypes.js","webpack:///./node_modules/d3-format/src/identity.js","webpack:///./node_modules/d3-format/src/locale.js","webpack:///./node_modules/d3-format/src/precisionRound.js","webpack:///./node_modules/d3-format/src/precisionFixed.js","webpack:///./node_modules/d3-scale/src/tickFormat.js","webpack:///./node_modules/d3-scale/src/linear.js","webpack:///./node_modules/core-js/modules/es.object.keys.js","webpack:///./node_modules/core-js/modules/es.math.trunc.js","webpack:///./src/views/Shaking.vue","webpack:///./src/views/Shaking.vue?a1ba","webpack:///./src/views/Shaking.vue?fbc1","webpack:///./src/assets/cloud.ts","webpack:///./src/views/Shaking.vue?4752","webpack:///./node_modules/core-js/modules/es.object.get-own-property-descriptors.js","webpack:///./node_modules/core-js/modules/es.object.get-own-property-descriptor.js","webpack:///./node_modules/d3-ease/src/exp.js","webpack:///./node_modules/d3-color/src/math.js","webpack:///./node_modules/d3-color/src/lab.js","webpack:///./node_modules/d3-interpolate/src/hcl.js","webpack:///./src/assets/manual.ts","webpack:///./node_modules/@babel/runtime/helpers/esm/objectSpread2.js","webpack:///./src/assets/keyframe-handler.ts","webpack:///./src/assets/jump.ts","webpack:///./src/assets/animator.ts"],"names":["noop","value","dispatch","t","i","n","arguments","length","_","test","Error","Dispatch","this","parseTypenames","typenames","types","trim","split","map","name","indexOf","slice","hasOwnProperty","type","get","c","set","callback","concat","push","prototype","constructor","on","typename","T","copy","call","that","args","Array","apply","cloudRadians","Math","PI","cw","ch","cloudText","d","text","cloudFont","cloudFontNormal","cloudFontSize","sqrt","cloudRotate","random","cloudPadding","cloudSprite","contextAndRatio","data","di","sprite","context","ratio","clearRect","x","y","maxh","save","font","style","weight","size","w","measureText","width","h","rotate","sr","sin","cr","cos","wcr","wsr","hcr","hsr","max","abs","translate","fillText","padding","lineWidth","strokeText","restore","height","xoff","yoff","x1","y1","x0","y0","hasText","pixels","getImageData","w32","seen","seenRow","j","k","m","cloudCollide","tag","board","sw","last","lx","sx","msx","cloudBounds","bounds","b0","b1","collideRects","a","b","archimedeanSpiral","e","rectangularSpiral","dy","dx","sign","zeroArray","cloudCanvas","document","createElement","functor","module","exports","fontSize","fontStyle","fontWeight","spiral","words","timeInterval","Infinity","event","timer","cloud","canvas","getContext","fillStyle","strokeStyle","textAlign","place","dxdy","startX","startY","maxDelta","s","dt","min","start","tags","sort","clearInterval","setInterval","step","Date","now","stop","spirals","archimedean","rectangular","e10","e5","e2","reverse","ticks","count","tickIncrement","isFinite","ceil","floor","power","log","LN10","error","pow","tickStep","step0","step1","NaN","f","delta","compare","left","lo","hi","mid","right","center","ascendingComparator","ascending","ascendingBisect","bisector","bisectRight","number","bisect","round","constants","unit","identity","normalize","isNaN","clamper","bimap","domain","range","interpolate","d0","d1","r0","r1","polymap","r","source","target","clamp","unknown","transformer","transform","untransform","piecewise","output","input","rescale","scale","invert","from","rangeRound","u","continuous","initRange","re","formatSpecifier","specifier","match","exec","FormatSpecifier","fill","align","symbol","zero","comma","precision","undefined","toString","toLocaleString","replace","formatDecimalParts","p","toExponential","coefficient","prefixExponent","g","grouping","substring","join","thousands","numerals","out","i1","i0","exponent","toFixed","formatDecimal","toPrecision","formatRounded","formatPrefixAuto","toUpperCase","prefixes","group","locale","formatGroup","Number","currencyPrefix","currency","currencySuffix","decimal","formatNumerals","String","percent","minus","nan","newFormat","formatTypes","prefix","toLowerCase","suffix","formatType","maybeSuffix","format","valuePrefix","valueSuffix","valueNegative","formatTrim","charCodeAt","formatPrefix","defaultLocale","definition","tickFormat","precisionPrefix","precisionRound","precisionFixed","linearish","nice","prestep","maxIter","linear","$","toObject","nativeKeys","fails","FAILS_ON_PRIMITIVES","stat","forced","keys","it","trunc","id","styleScheme","viewBox","preserveAspectRatio","class","wordleData","collection","fileReader","FileReader","uploadFilename","animationModes","bubble","colorful","chill","glisten","electric","animationMode","fontFamily","colorSchemes","colorScheme","easeTypes","easeType","strokeWidth","rotation","duration","customColor","presetColors","url","then","cloudManager","bgAnimator","animator","createGif","play","err","console","render","__scopeId","CloudManager","styleSheet","svgid","canvasid","loadCanvasFlag","loadSvgFlag","canvasHandler","self","assignColor","plotHandler","testCloud","finalData","plotOnSvgWithConfig","update","mode","wordScale","idx","word","frequency","spiralType","forEach","color","DESCRIPTORS","ownKeys","toIndexedObject","getOwnPropertyDescriptorModule","createProperty","sham","getOwnPropertyDescriptors","object","key","descriptor","O","getOwnPropertyDescriptor","result","index","nativeGetOwnPropertyDescriptor","FORCED","expInOut","radians","degrees","K","Xn","Yn","Zn","t0","t1","t2","t3","labConvert","o","Lab","l","opacity","Hcl","hcl2lab","z","rgb2lrgb","xyz2lab","lab","lab2xyz","lrgb2rgb","hclConvert","atan2","hcl","define","brighter","darker","rgb","hue","end","keyframes","colors","stage","enumerableOnly","Object","getOwnPropertySymbols","symbols","filter","sym","enumerable","_objectSpread2","defineProperty","defineProperties","minNumGroup","sampleFont","sampleItalic","italicRange","sampleWeight","weightRange","sampleItalicInterval","sampleWeightInterval","sampleItalicMid","sampleWeightMid","wordLength","speed","entropy","alpha","keyFrames","dance","getDiscoKeyFrames","getSplitKeyframes","swing","getSwingingKeyFrames","maxNumGroup","numGroup","groupKeyFrames","italicDelta","weightDelta","fontMid","italic","fontStart","fontEnd","fontWideMid","fontWideStart","animation","backupFrames","fid","iter","al","tl","move","groupKf","theta","dis","_move","_center","_rotate","_neg_rotate","randXD","randY","jump","FONTURL","time","pace","distance","p1","p2","lerp","cross","gl","MAX_BEZIER_STEPS","BEZIER_STEP_SIZE","EPSILON","points","children","area","cur","next","p0","dist","steps","tick","uniform1f","drawElements","TRIANGLES","UNSIGNED_SHORT","requestAnimationFrame","getRoots","polys","root","parent","inside","getPolys","path","getPath","commands","x2","y2","moveTo","cubicTo","conicTo","close","totalPoints","reduce","sum","vertexData","Float32Array","vertexCount","process","poly","coords","holes","child","statement","defaultvs","getElementById","polyAll","indices","staticvs","vsGenerator","timeGran","yAmplitude","yExtent","xExtent","xAmplitude","xPosStr","yPosStr","viewport","vs","VERTEX_SHADER","ps","FRAGMENT_SHADER","prog","bindAttribLocation","getUniformLocation","uScale","uOffset","uColor","uTime","u_resolutionLoc","fragColor","useProgram","uniform2fv","uniform4fv","uniform2f","clearColor","clear","COLOR_BUFFER_BIT","vertBuffer","createBuffer","bindBuffer","ARRAY_BUFFER","bufferData","STATIC_DRAW","indxBuffer","indexData","Uint16Array","ELEMENT_ARRAY_BUFFER","enableVertexAttribArray","vertexAttribPointer","FLOAT","flush","fontUrl","load","fontMeta","alert","configs","assign","order","delay","ease","origin","frameCounter","ckf","nkf","frameAt","phase","setValWithRatio","fontString","getCss","trues","fc","groupManagers","extent","wordMap","Map","numGroups","field","gm","centers","numWordsPerGroup","assignedWords","xy","startIdx","endIdx","positions","alias","kmeans","wordBags","getMatrix","indexes","v","gifFlag","replay","svgFlag","wave","reset","playWaving","playSwinging","playDancing","playSplitting","svg","display","plotOnSvg","keyFrameHandler","getKeyFrames","divideMode","createManagers","assignKeyFrame","divideGroup","startPlay","getDivideMode","gms","elapsed","totalWords","cfa","setFrameCounter","fs","updateWord","updateOnSvg","gif","addFrame","res","quality","param","blob","wlink","setAttribute","URL","createObjectURL","addEventListener","remove","click","plink","encodeURIComponent","JSON","stringify","groupNum","wordsCopy","array","tempVal","randIdx","currIdx","row","col","matrix","slot"],"mappings":"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","file":"js/chunk-62c3f4f6.ebbc927a.js","sourcesContent":["var noop = {value: function() {}};\n\nfunction dispatch() {\n  for (var i = 0, n = arguments.length, _ = {}, t; i < n; ++i) {\n    if (!(t = arguments[i] + \"\") || (t in _) || /[\\s.]/.test(t)) throw new Error(\"illegal type: \" + t);\n    _[t] = [];\n  }\n  return new Dispatch(_);\n}\n\nfunction Dispatch(_) {\n  this._ = _;\n}\n\nfunction parseTypenames(typenames, types) {\n  return typenames.trim().split(/^|\\s+/).map(function(t) {\n    var name = \"\", i = t.indexOf(\".\");\n    if (i >= 0) name = t.slice(i + 1), t = t.slice(0, i);\n    if (t && !types.hasOwnProperty(t)) throw new Error(\"unknown type: \" + t);\n    return {type: t, name: name};\n  });\n}\n\nDispatch.prototype = dispatch.prototype = {\n  constructor: Dispatch,\n  on: function(typename, callback) {\n    var _ = this._,\n        T = parseTypenames(typename + \"\", _),\n        t,\n        i = -1,\n        n = T.length;\n\n    // If no callback was specified, return the callback of the given type and name.\n    if (arguments.length < 2) {\n      while (++i < n) if ((t = (typename = T[i]).type) && (t = get(_[t], typename.name))) return t;\n      return;\n    }\n\n    // If a type was specified, set the callback for the given type and name.\n    // Otherwise, if a null callback was specified, remove callbacks of the given name.\n    if (callback != null && typeof callback !== \"function\") throw new Error(\"invalid callback: \" + callback);\n    while (++i < n) {\n      if (t = (typename = T[i]).type) _[t] = set(_[t], typename.name, callback);\n      else if (callback == null) for (t in _) _[t] = set(_[t], typename.name, null);\n    }\n\n    return this;\n  },\n  copy: function() {\n    var copy = {}, _ = this._;\n    for (var t in _) copy[t] = _[t].slice();\n    return new Dispatch(copy);\n  },\n  call: function(type, that) {\n    if ((n = arguments.length - 2) > 0) for (var args = new Array(n), i = 0, n, t; i < n; ++i) args[i] = arguments[i + 2];\n    if (!this._.hasOwnProperty(type)) throw new Error(\"unknown type: \" + type);\n    for (t = this._[type], i = 0, n = t.length; i < n; ++i) t[i].value.apply(that, args);\n  },\n  apply: function(type, that, args) {\n    if (!this._.hasOwnProperty(type)) throw new Error(\"unknown type: \" + type);\n    for (var t = this._[type], i = 0, n = t.length; i < n; ++i) t[i].value.apply(that, args);\n  }\n};\n\nfunction get(type, name) {\n  for (var i = 0, n = type.length, c; i < n; ++i) {\n    if ((c = type[i]).name === name) {\n      return c.value;\n    }\n  }\n}\n\nfunction set(type, name, callback) {\n  for (var i = 0, n = type.length; i < n; ++i) {\n    if (type[i].name === name) {\n      type[i] = noop, type = type.slice(0, i).concat(type.slice(i + 1));\n      break;\n    }\n  }\n  if (callback != null) type.push({name: name, value: callback});\n  return type;\n}\n\nexport default dispatch;\n","// Word cloud layout by Jason Davies, https://www.jasondavies.com/wordcloud/\n// Algorithm due to Jonathan Feinberg, http://static.mrfeinberg.com/bv_ch03.pdf\n\nvar dispatch = require(\"d3-dispatch\").dispatch;\n\nvar cloudRadians = Math.PI / 180,\n    cw = 1 << 11 >> 5,\n    ch = 1 << 11;\n\nmodule.exports = function() {\n  var size = [256, 256],\n      text = cloudText,\n      font = cloudFont,\n      fontSize = cloudFontSize,\n      fontStyle = cloudFontNormal,\n      fontWeight = cloudFontNormal,\n      rotate = cloudRotate,\n      padding = cloudPadding,\n      spiral = archimedeanSpiral,\n      words = [],\n      timeInterval = Infinity,\n      event = dispatch(\"word\", \"end\"),\n      timer = null,\n      random = Math.random,\n      cloud = {},\n      canvas = cloudCanvas;\n\n  cloud.canvas = function(_) {\n    return arguments.length ? (canvas = functor(_), cloud) : canvas;\n  };\n\n  cloud.start = function() {\n    var contextAndRatio = getContext(canvas()),\n        board = zeroArray((size[0] >> 5) * size[1]),\n        bounds = null,\n        n = words.length,\n        i = -1,\n        tags = [],\n        data = words.map(function(d, i) {\n          d.text = text.call(this, d, i);\n          d.font = font.call(this, d, i);\n          d.style = fontStyle.call(this, d, i);\n          d.weight = fontWeight.call(this, d, i);\n          d.rotate = rotate.call(this, d, i);\n          d.size = ~~fontSize.call(this, d, i);\n          d.padding = padding.call(this, d, i);\n          return d;\n        }).sort(function(a, b) { return b.size - a.size; });\n\n    if (timer) clearInterval(timer);\n    timer = setInterval(step, 0);\n    step();\n\n    return cloud;\n\n    function step() {\n      var start = Date.now();\n      while (Date.now() - start < timeInterval && ++i < n && timer) {\n        var d = data[i];\n        d.x = (size[0] * (random() + .5)) >> 1;\n        d.y = (size[1] * (random() + .5)) >> 1;\n        cloudSprite(contextAndRatio, d, data, i);\n        if (d.hasText && place(board, d, bounds)) {\n          tags.push(d);\n          event.call(\"word\", cloud, d);\n          if (bounds) cloudBounds(bounds, d);\n          else bounds = [{x: d.x + d.x0, y: d.y + d.y0}, {x: d.x + d.x1, y: d.y + d.y1}];\n          // Temporary hack\n          d.x -= size[0] >> 1;\n          d.y -= size[1] >> 1;\n        }\n      }\n      if (i >= n) {\n        cloud.stop();\n        event.call(\"end\", cloud, tags, bounds);\n      }\n    }\n  }\n\n  cloud.stop = function() {\n    if (timer) {\n      clearInterval(timer);\n      timer = null;\n    }\n    return cloud;\n  };\n\n  function getContext(canvas) {\n    canvas.width = canvas.height = 1;\n    var ratio = Math.sqrt(canvas.getContext(\"2d\").getImageData(0, 0, 1, 1).data.length >> 2);\n    canvas.width = (cw << 5) / ratio;\n    canvas.height = ch / ratio;\n\n    var context = canvas.getContext(\"2d\");\n    context.fillStyle = context.strokeStyle = \"red\";\n    context.textAlign = \"center\";\n\n    return {context: context, ratio: ratio};\n  }\n\n  function place(board, tag, bounds) {\n    var perimeter = [{x: 0, y: 0}, {x: size[0], y: size[1]}],\n        startX = tag.x,\n        startY = tag.y,\n        maxDelta = Math.sqrt(size[0] * size[0] + size[1] * size[1]),\n        s = spiral(size),\n        dt = random() < .5 ? 1 : -1,\n        t = -dt,\n        dxdy,\n        dx,\n        dy;\n\n    while (dxdy = s(t += dt)) {\n      dx = ~~dxdy[0];\n      dy = ~~dxdy[1];\n\n      if (Math.min(Math.abs(dx), Math.abs(dy)) >= maxDelta) break;\n\n      tag.x = startX + dx;\n      tag.y = startY + dy;\n\n      if (tag.x + tag.x0 < 0 || tag.y + tag.y0 < 0 ||\n          tag.x + tag.x1 > size[0] || tag.y + tag.y1 > size[1]) continue;\n      // TODO only check for collisions within current bounds.\n      if (!bounds || !cloudCollide(tag, board, size[0])) {\n        if (!bounds || collideRects(tag, bounds)) {\n          var sprite = tag.sprite,\n              w = tag.width >> 5,\n              sw = size[0] >> 5,\n              lx = tag.x - (w << 4),\n              sx = lx & 0x7f,\n              msx = 32 - sx,\n              h = tag.y1 - tag.y0,\n              x = (tag.y + tag.y0) * sw + (lx >> 5),\n              last;\n          for (var j = 0; j < h; j++) {\n            last = 0;\n            for (var i = 0; i <= w; i++) {\n              board[x + i] |= (last << msx) | (i < w ? (last = sprite[j * w + i]) >>> sx : 0);\n            }\n            x += sw;\n          }\n          delete tag.sprite;\n          return true;\n        }\n      }\n    }\n    return false;\n  }\n\n  cloud.timeInterval = function(_) {\n    return arguments.length ? (timeInterval = _ == null ? Infinity : _, cloud) : timeInterval;\n  };\n\n  cloud.words = function(_) {\n    return arguments.length ? (words = _, cloud) : words;\n  };\n\n  cloud.size = function(_) {\n    return arguments.length ? (size = [+_[0], +_[1]], cloud) : size;\n  };\n\n  cloud.font = function(_) {\n    return arguments.length ? (font = functor(_), cloud) : font;\n  };\n\n  cloud.fontStyle = function(_) {\n    return arguments.length ? (fontStyle = functor(_), cloud) : fontStyle;\n  };\n\n  cloud.fontWeight = function(_) {\n    return arguments.length ? (fontWeight = functor(_), cloud) : fontWeight;\n  };\n\n  cloud.rotate = function(_) {\n    return arguments.length ? (rotate = functor(_), cloud) : rotate;\n  };\n\n  cloud.text = function(_) {\n    return arguments.length ? (text = functor(_), cloud) : text;\n  };\n\n  cloud.spiral = function(_) {\n    return arguments.length ? (spiral = spirals[_] || _, cloud) : spiral;\n  };\n\n  cloud.fontSize = function(_) {\n    return arguments.length ? (fontSize = functor(_), cloud) : fontSize;\n  };\n\n  cloud.padding = function(_) {\n    return arguments.length ? (padding = functor(_), cloud) : padding;\n  };\n\n  cloud.random = function(_) {\n    return arguments.length ? (random = _, cloud) : random;\n  };\n\n  cloud.on = function() {\n    var value = event.on.apply(event, arguments);\n    return value === event ? cloud : value;\n  };\n\n  return cloud;\n};\n\nfunction cloudText(d) {\n  return d.text;\n}\n\nfunction cloudFont() {\n  return \"serif\";\n}\n\nfunction cloudFontNormal() {\n  return \"normal\";\n}\n\nfunction cloudFontSize(d) {\n  return Math.sqrt(d.value);\n}\n\nfunction cloudRotate() {\n  return (~~(Math.random() * 6) - 3) * 30;\n}\n\nfunction cloudPadding() {\n  return 1;\n}\n\n// Fetches a monochrome sprite bitmap for the specified text.\n// Load in batches for speed.\nfunction cloudSprite(contextAndRatio, d, data, di) {\n  if (d.sprite) return;\n  var c = contextAndRatio.context,\n      ratio = contextAndRatio.ratio;\n\n  c.clearRect(0, 0, (cw << 5) / ratio, ch / ratio);\n  var x = 0,\n      y = 0,\n      maxh = 0,\n      n = data.length;\n  --di;\n  while (++di < n) {\n    d = data[di];\n    c.save();\n    c.font = d.style + \" \" + d.weight + \" \" + ~~((d.size + 1) / ratio) + \"px \" + d.font;\n    var w = c.measureText(d.text + \"m\").width * ratio,\n        h = d.size << 1;\n    if (d.rotate) {\n      var sr = Math.sin(d.rotate * cloudRadians),\n          cr = Math.cos(d.rotate * cloudRadians),\n          wcr = w * cr,\n          wsr = w * sr,\n          hcr = h * cr,\n          hsr = h * sr;\n      w = (Math.max(Math.abs(wcr + hsr), Math.abs(wcr - hsr)) + 0x1f) >> 5 << 5;\n      h = ~~Math.max(Math.abs(wsr + hcr), Math.abs(wsr - hcr));\n    } else {\n      w = (w + 0x1f) >> 5 << 5;\n    }\n    if (h > maxh) maxh = h;\n    if (x + w >= (cw << 5)) {\n      x = 0;\n      y += maxh;\n      maxh = 0;\n    }\n    if (y + h >= ch) break;\n    c.translate((x + (w >> 1)) / ratio, (y + (h >> 1)) / ratio);\n    if (d.rotate) c.rotate(d.rotate * cloudRadians);\n    c.fillText(d.text, 0, 0);\n    if (d.padding) c.lineWidth = 2 * d.padding, c.strokeText(d.text, 0, 0);\n    c.restore();\n    d.width = w;\n    d.height = h;\n    d.xoff = x;\n    d.yoff = y;\n    d.x1 = w >> 1;\n    d.y1 = h >> 1;\n    d.x0 = -d.x1;\n    d.y0 = -d.y1;\n    d.hasText = true;\n    x += w;\n  }\n  var pixels = c.getImageData(0, 0, (cw << 5) / ratio, ch / ratio).data,\n      sprite = [];\n  while (--di >= 0) {\n    d = data[di];\n    if (!d.hasText) continue;\n    var w = d.width,\n        w32 = w >> 5,\n        h = d.y1 - d.y0;\n    // Zero the buffer\n    for (var i = 0; i < h * w32; i++) sprite[i] = 0;\n    x = d.xoff;\n    if (x == null) return;\n    y = d.yoff;\n    var seen = 0,\n        seenRow = -1;\n    for (var j = 0; j < h; j++) {\n      for (var i = 0; i < w; i++) {\n        var k = w32 * j + (i >> 5),\n            m = pixels[((y + j) * (cw << 5) + (x + i)) << 2] ? 1 << (31 - (i % 32)) : 0;\n        sprite[k] |= m;\n        seen |= m;\n      }\n      if (seen) seenRow = j;\n      else {\n        d.y0++;\n        h--;\n        j--;\n        y++;\n      }\n    }\n    d.y1 = d.y0 + seenRow;\n    d.sprite = sprite.slice(0, (d.y1 - d.y0) * w32);\n  }\n}\n\n// Use mask-based collision detection.\nfunction cloudCollide(tag, board, sw) {\n  sw >>= 5;\n  var sprite = tag.sprite,\n      w = tag.width >> 5,\n      lx = tag.x - (w << 4),\n      sx = lx & 0x7f,\n      msx = 32 - sx,\n      h = tag.y1 - tag.y0,\n      x = (tag.y + tag.y0) * sw + (lx >> 5),\n      last;\n  for (var j = 0; j < h; j++) {\n    last = 0;\n    for (var i = 0; i <= w; i++) {\n      if (((last << msx) | (i < w ? (last = sprite[j * w + i]) >>> sx : 0))\n          & board[x + i]) return true;\n    }\n    x += sw;\n  }\n  return false;\n}\n\nfunction cloudBounds(bounds, d) {\n  var b0 = bounds[0],\n      b1 = bounds[1];\n  if (d.x + d.x0 < b0.x) b0.x = d.x + d.x0;\n  if (d.y + d.y0 < b0.y) b0.y = d.y + d.y0;\n  if (d.x + d.x1 > b1.x) b1.x = d.x + d.x1;\n  if (d.y + d.y1 > b1.y) b1.y = d.y + d.y1;\n}\n\nfunction collideRects(a, b) {\n  return a.x + a.x1 > b[0].x && a.x + a.x0 < b[1].x && a.y + a.y1 > b[0].y && a.y + a.y0 < b[1].y;\n}\n\nfunction archimedeanSpiral(size) {\n  var e = size[0] / size[1];\n  return function(t) {\n    return [e * (t *= .1) * Math.cos(t), t * Math.sin(t)];\n  };\n}\n\nfunction rectangularSpiral(size) {\n  var dy = 4,\n      dx = dy * size[0] / size[1],\n      x = 0,\n      y = 0;\n  return function(t) {\n    var sign = t < 0 ? -1 : 1;\n    // See triangular numbers: T_n = n * (n + 1) / 2.\n    switch ((Math.sqrt(1 + 4 * sign * t) - sign) & 3) {\n      case 0:  x += dx; break;\n      case 1:  y += dy; break;\n      case 2:  x -= dx; break;\n      default: y -= dy; break;\n    }\n    return [x, y];\n  };\n}\n\n// TODO reuse arrays?\nfunction zeroArray(n) {\n  var a = [],\n      i = -1;\n  while (++i < n) a[i] = 0;\n  return a;\n}\n\nfunction cloudCanvas() {\n  return document.createElement(\"canvas\");\n}\n\nfunction functor(d) {\n  return typeof d === \"function\" ? d : function() { return d; };\n}\n\nvar spirals = {\n  archimedean: archimedeanSpiral,\n  rectangular: rectangularSpiral\n};\n","var e10 = Math.sqrt(50),\n    e5 = Math.sqrt(10),\n    e2 = Math.sqrt(2);\n\nexport default function(start, stop, count) {\n  var reverse,\n      i = -1,\n      n,\n      ticks,\n      step;\n\n  stop = +stop, start = +start, count = +count;\n  if (start === stop && count > 0) return [start];\n  if (reverse = stop < start) n = start, start = stop, stop = n;\n  if ((step = tickIncrement(start, stop, count)) === 0 || !isFinite(step)) return [];\n\n  if (step > 0) {\n    start = Math.ceil(start / step);\n    stop = Math.floor(stop / step);\n    ticks = new Array(n = Math.ceil(stop - start + 1));\n    while (++i < n) ticks[i] = (start + i) * step;\n  } else {\n    step = -step;\n    start = Math.ceil(start * step);\n    stop = Math.floor(stop * step);\n    ticks = new Array(n = Math.ceil(stop - start + 1));\n    while (++i < n) ticks[i] = (start + i) / step;\n  }\n\n  if (reverse) ticks.reverse();\n\n  return ticks;\n}\n\nexport function tickIncrement(start, stop, count) {\n  var step = (stop - start) / Math.max(0, count),\n      power = Math.floor(Math.log(step) / Math.LN10),\n      error = step / Math.pow(10, power);\n  return power >= 0\n      ? (error >= e10 ? 10 : error >= e5 ? 5 : error >= e2 ? 2 : 1) * Math.pow(10, power)\n      : -Math.pow(10, -power) / (error >= e10 ? 10 : error >= e5 ? 5 : error >= e2 ? 2 : 1);\n}\n\nexport function tickStep(start, stop, count) {\n  var step0 = Math.abs(stop - start) / Math.max(0, count),\n      step1 = Math.pow(10, Math.floor(Math.log(step0) / Math.LN10)),\n      error = step0 / step1;\n  if (error >= e10) step1 *= 10;\n  else if (error >= e5) step1 *= 5;\n  else if (error >= e2) step1 *= 2;\n  return stop < start ? -step1 : step1;\n}\n","export default function(a, b) {\n  return a < b ? -1 : a > b ? 1 : a >= b ? 0 : NaN;\n}\n","import ascending from \"./ascending.js\";\n\nexport default function(f) {\n  let delta = f;\n  let compare = f;\n\n  if (f.length === 1) {\n    delta = (d, x) => f(d) - x;\n    compare = ascendingComparator(f);\n  }\n\n  function left(a, x, lo, hi) {\n    if (lo == null) lo = 0;\n    if (hi == null) hi = a.length;\n    while (lo < hi) {\n      const mid = (lo + hi) >>> 1;\n      if (compare(a[mid], x) < 0) lo = mid + 1;\n      else hi = mid;\n    }\n    return lo;\n  }\n\n  function right(a, x, lo, hi) {\n    if (lo == null) lo = 0;\n    if (hi == null) hi = a.length;\n    while (lo < hi) {\n      const mid = (lo + hi) >>> 1;\n      if (compare(a[mid], x) > 0) hi = mid;\n      else lo = mid + 1;\n    }\n    return lo;\n  }\n\n  function center(a, x, lo, hi) {\n    if (lo == null) lo = 0;\n    if (hi == null) hi = a.length;\n    const i = left(a, x, lo, hi - 1);\n    return i > lo && delta(a[i - 1], x) > -delta(a[i], x) ? i - 1 : i;\n  }\n\n  return {left, center, right};\n}\n\nfunction ascendingComparator(f) {\n  return (d, x) => ascending(f(d), x);\n}\n","export default function(x) {\n  return x === null ? NaN : +x;\n}\n\nexport function* numbers(values, valueof) {\n  if (valueof === undefined) {\n    for (let value of values) {\n      if (value != null && (value = +value) >= value) {\n        yield value;\n      }\n    }\n  } else {\n    let index = -1;\n    for (let value of values) {\n      if ((value = valueof(value, ++index, values)) != null && (value = +value) >= value) {\n        yield value;\n      }\n    }\n  }\n}\n","import ascending from \"./ascending.js\";\nimport bisector from \"./bisector.js\";\nimport number from \"./number.js\";\n\nconst ascendingBisect = bisector(ascending);\nexport const bisectRight = ascendingBisect.right;\nexport const bisectLeft = ascendingBisect.left;\nexport const bisectCenter = bisector(number).center;\nexport default bisectRight;\n","export default function(a, b) {\n  return a = +a, b = +b, function(t) {\n    return Math.round(a * (1 - t) + b * t);\n  };\n}\n","export default function constants(x) {\n  return function() {\n    return x;\n  };\n}\n","export default function number(x) {\n  return +x;\n}\n","import {bisect} from \"d3-array\";\nimport {interpolate as interpolateValue, interpolateNumber, interpolateRound} from \"d3-interpolate\";\nimport constant from \"./constant.js\";\nimport number from \"./number.js\";\n\nvar unit = [0, 1];\n\nexport function identity(x) {\n  return x;\n}\n\nfunction normalize(a, b) {\n  return (b -= (a = +a))\n      ? function(x) { return (x - a) / b; }\n      : constant(isNaN(b) ? NaN : 0.5);\n}\n\nfunction clamper(a, b) {\n  var t;\n  if (a > b) t = a, a = b, b = t;\n  return function(x) { return Math.max(a, Math.min(b, x)); };\n}\n\n// normalize(a, b)(x) takes a domain value x in [a,b] and returns the corresponding parameter t in [0,1].\n// interpolate(a, b)(t) takes a parameter t in [0,1] and returns the corresponding range value x in [a,b].\nfunction bimap(domain, range, interpolate) {\n  var d0 = domain[0], d1 = domain[1], r0 = range[0], r1 = range[1];\n  if (d1 < d0) d0 = normalize(d1, d0), r0 = interpolate(r1, r0);\n  else d0 = normalize(d0, d1), r0 = interpolate(r0, r1);\n  return function(x) { return r0(d0(x)); };\n}\n\nfunction polymap(domain, range, interpolate) {\n  var j = Math.min(domain.length, range.length) - 1,\n      d = new Array(j),\n      r = new Array(j),\n      i = -1;\n\n  // Reverse descending domains.\n  if (domain[j] < domain[0]) {\n    domain = domain.slice().reverse();\n    range = range.slice().reverse();\n  }\n\n  while (++i < j) {\n    d[i] = normalize(domain[i], domain[i + 1]);\n    r[i] = interpolate(range[i], range[i + 1]);\n  }\n\n  return function(x) {\n    var i = bisect(domain, x, 1, j) - 1;\n    return r[i](d[i](x));\n  };\n}\n\nexport function copy(source, target) {\n  return target\n      .domain(source.domain())\n      .range(source.range())\n      .interpolate(source.interpolate())\n      .clamp(source.clamp())\n      .unknown(source.unknown());\n}\n\nexport function transformer() {\n  var domain = unit,\n      range = unit,\n      interpolate = interpolateValue,\n      transform,\n      untransform,\n      unknown,\n      clamp = identity,\n      piecewise,\n      output,\n      input;\n\n  function rescale() {\n    var n = Math.min(domain.length, range.length);\n    if (clamp !== identity) clamp = clamper(domain[0], domain[n - 1]);\n    piecewise = n > 2 ? polymap : bimap;\n    output = input = null;\n    return scale;\n  }\n\n  function scale(x) {\n    return isNaN(x = +x) ? unknown : (output || (output = piecewise(domain.map(transform), range, interpolate)))(transform(clamp(x)));\n  }\n\n  scale.invert = function(y) {\n    return clamp(untransform((input || (input = piecewise(range, domain.map(transform), interpolateNumber)))(y)));\n  };\n\n  scale.domain = function(_) {\n    return arguments.length ? (domain = Array.from(_, number), rescale()) : domain.slice();\n  };\n\n  scale.range = function(_) {\n    return arguments.length ? (range = Array.from(_), rescale()) : range.slice();\n  };\n\n  scale.rangeRound = function(_) {\n    return range = Array.from(_), interpolate = interpolateRound, rescale();\n  };\n\n  scale.clamp = function(_) {\n    return arguments.length ? (clamp = _ ? true : identity, rescale()) : clamp !== identity;\n  };\n\n  scale.interpolate = function(_) {\n    return arguments.length ? (interpolate = _, rescale()) : interpolate;\n  };\n\n  scale.unknown = function(_) {\n    return arguments.length ? (unknown = _, scale) : unknown;\n  };\n\n  return function(t, u) {\n    transform = t, untransform = u;\n    return rescale();\n  };\n}\n\nexport default function continuous() {\n  return transformer()(identity, identity);\n}\n","export function initRange(domain, range) {\n  switch (arguments.length) {\n    case 0: break;\n    case 1: this.range(domain); break;\n    default: this.range(range).domain(domain); break;\n  }\n  return this;\n}\n\nexport function initInterpolator(domain, interpolator) {\n  switch (arguments.length) {\n    case 0: break;\n    case 1: {\n      if (typeof domain === \"function\") this.interpolator(domain);\n      else this.range(domain);\n      break;\n    }\n    default: {\n      this.domain(domain);\n      if (typeof interpolator === \"function\") this.interpolator(interpolator);\n      else this.range(interpolator);\n      break;\n    }\n  }\n  return this;\n}\n","// [[fill]align][sign][symbol][0][width][,][.precision][~][type]\nvar re = /^(?:(.)?([<>=^]))?([+\\-( ])?([$#])?(0)?(\\d+)?(,)?(\\.\\d+)?(~)?([a-z%])?$/i;\n\nexport default function formatSpecifier(specifier) {\n  if (!(match = re.exec(specifier))) throw new Error(\"invalid format: \" + specifier);\n  var match;\n  return new FormatSpecifier({\n    fill: match[1],\n    align: match[2],\n    sign: match[3],\n    symbol: match[4],\n    zero: match[5],\n    width: match[6],\n    comma: match[7],\n    precision: match[8] && match[8].slice(1),\n    trim: match[9],\n    type: match[10]\n  });\n}\n\nformatSpecifier.prototype = FormatSpecifier.prototype; // instanceof\n\nexport function FormatSpecifier(specifier) {\n  this.fill = specifier.fill === undefined ? \" \" : specifier.fill + \"\";\n  this.align = specifier.align === undefined ? \">\" : specifier.align + \"\";\n  this.sign = specifier.sign === undefined ? \"-\" : specifier.sign + \"\";\n  this.symbol = specifier.symbol === undefined ? \"\" : specifier.symbol + \"\";\n  this.zero = !!specifier.zero;\n  this.width = specifier.width === undefined ? undefined : +specifier.width;\n  this.comma = !!specifier.comma;\n  this.precision = specifier.precision === undefined ? undefined : +specifier.precision;\n  this.trim = !!specifier.trim;\n  this.type = specifier.type === undefined ? \"\" : specifier.type + \"\";\n}\n\nFormatSpecifier.prototype.toString = function() {\n  return this.fill\n      + this.align\n      + this.sign\n      + this.symbol\n      + (this.zero ? \"0\" : \"\")\n      + (this.width === undefined ? \"\" : Math.max(1, this.width | 0))\n      + (this.comma ? \",\" : \"\")\n      + (this.precision === undefined ? \"\" : \".\" + Math.max(0, this.precision | 0))\n      + (this.trim ? \"~\" : \"\")\n      + this.type;\n};\n","export default function(x) {\n  return Math.abs(x = Math.round(x)) >= 1e21\n      ? x.toLocaleString(\"en\").replace(/,/g, \"\")\n      : x.toString(10);\n}\n\n// Computes the decimal coefficient and exponent of the specified number x with\n// significant digits p, where x is positive and p is in [1, 21] or undefined.\n// For example, formatDecimalParts(1.23) returns [\"123\", 0].\nexport function formatDecimalParts(x, p) {\n  if ((i = (x = p ? x.toExponential(p - 1) : x.toExponential()).indexOf(\"e\")) < 0) return null; // NaN, ±Infinity\n  var i, coefficient = x.slice(0, i);\n\n  // The string returned by toExponential either has the form \\d\\.\\d+e[-+]\\d+\n  // (e.g., 1.2e+3) or the form \\de[-+]\\d+ (e.g., 1e+3).\n  return [\n    coefficient.length > 1 ? coefficient[0] + coefficient.slice(2) : coefficient,\n    +x.slice(i + 1)\n  ];\n}\n","import {formatDecimalParts} from \"./formatDecimal.js\";\n\nexport default function(x) {\n  return x = formatDecimalParts(Math.abs(x)), x ? x[1] : NaN;\n}\n","import {formatDecimalParts} from \"./formatDecimal.js\";\n\nexport var prefixExponent;\n\nexport default function(x, p) {\n  var d = formatDecimalParts(x, p);\n  if (!d) return x + \"\";\n  var coefficient = d[0],\n      exponent = d[1],\n      i = exponent - (prefixExponent = Math.max(-8, Math.min(8, Math.floor(exponent / 3))) * 3) + 1,\n      n = coefficient.length;\n  return i === n ? coefficient\n      : i > n ? coefficient + new Array(i - n + 1).join(\"0\")\n      : i > 0 ? coefficient.slice(0, i) + \".\" + coefficient.slice(i)\n      : \"0.\" + new Array(1 - i).join(\"0\") + formatDecimalParts(x, Math.max(0, p + i - 1))[0]; // less than 1y!\n}\n","import formatLocale from \"./locale.js\";\n\nvar locale;\nexport var format;\nexport var formatPrefix;\n\ndefaultLocale({\n  thousands: \",\",\n  grouping: [3],\n  currency: [\"$\", \"\"]\n});\n\nexport default function defaultLocale(definition) {\n  locale = formatLocale(definition);\n  format = locale.format;\n  formatPrefix = locale.formatPrefix;\n  return locale;\n}\n","import exponent from \"./exponent.js\";\n\nexport default function(step, value) {\n  return Math.max(0, Math.max(-8, Math.min(8, Math.floor(exponent(value) / 3))) * 3 - exponent(Math.abs(step)));\n}\n","export default function(grouping, thousands) {\n  return function(value, width) {\n    var i = value.length,\n        t = [],\n        j = 0,\n        g = grouping[0],\n        length = 0;\n\n    while (i > 0 && g > 0) {\n      if (length + g + 1 > width) g = Math.max(1, width - length);\n      t.push(value.substring(i -= g, i + g));\n      if ((length += g + 1) > width) break;\n      g = grouping[j = (j + 1) % grouping.length];\n    }\n\n    return t.reverse().join(thousands);\n  };\n}\n","export default function(numerals) {\n  return function(value) {\n    return value.replace(/[0-9]/g, function(i) {\n      return numerals[+i];\n    });\n  };\n}\n","// Trims insignificant zeros, e.g., replaces 1.2000k with 1.2k.\nexport default function(s) {\n  out: for (var n = s.length, i = 1, i0 = -1, i1; i < n; ++i) {\n    switch (s[i]) {\n      case \".\": i0 = i1 = i; break;\n      case \"0\": if (i0 === 0) i0 = i; i1 = i; break;\n      default: if (!+s[i]) break out; if (i0 > 0) i0 = 0; break;\n    }\n  }\n  return i0 > 0 ? s.slice(0, i0) + s.slice(i1 + 1) : s;\n}\n","import {formatDecimalParts} from \"./formatDecimal.js\";\n\nexport default function(x, p) {\n  var d = formatDecimalParts(x, p);\n  if (!d) return x + \"\";\n  var coefficient = d[0],\n      exponent = d[1];\n  return exponent < 0 ? \"0.\" + new Array(-exponent).join(\"0\") + coefficient\n      : coefficient.length > exponent + 1 ? coefficient.slice(0, exponent + 1) + \".\" + coefficient.slice(exponent + 1)\n      : coefficient + new Array(exponent - coefficient.length + 2).join(\"0\");\n}\n","import formatDecimal from \"./formatDecimal.js\";\nimport formatPrefixAuto from \"./formatPrefixAuto.js\";\nimport formatRounded from \"./formatRounded.js\";\n\nexport default {\n  \"%\": (x, p) => (x * 100).toFixed(p),\n  \"b\": (x) => Math.round(x).toString(2),\n  \"c\": (x) => x + \"\",\n  \"d\": formatDecimal,\n  \"e\": (x, p) => x.toExponential(p),\n  \"f\": (x, p) => x.toFixed(p),\n  \"g\": (x, p) => x.toPrecision(p),\n  \"o\": (x) => Math.round(x).toString(8),\n  \"p\": (x, p) => formatRounded(x * 100, p),\n  \"r\": formatRounded,\n  \"s\": formatPrefixAuto,\n  \"X\": (x) => Math.round(x).toString(16).toUpperCase(),\n  \"x\": (x) => Math.round(x).toString(16)\n};\n","export default function(x) {\n  return x;\n}\n","import exponent from \"./exponent.js\";\nimport formatGroup from \"./formatGroup.js\";\nimport formatNumerals from \"./formatNumerals.js\";\nimport formatSpecifier from \"./formatSpecifier.js\";\nimport formatTrim from \"./formatTrim.js\";\nimport formatTypes from \"./formatTypes.js\";\nimport {prefixExponent} from \"./formatPrefixAuto.js\";\nimport identity from \"./identity.js\";\n\nvar map = Array.prototype.map,\n    prefixes = [\"y\",\"z\",\"a\",\"f\",\"p\",\"n\",\"µ\",\"m\",\"\",\"k\",\"M\",\"G\",\"T\",\"P\",\"E\",\"Z\",\"Y\"];\n\nexport default function(locale) {\n  var group = locale.grouping === undefined || locale.thousands === undefined ? identity : formatGroup(map.call(locale.grouping, Number), locale.thousands + \"\"),\n      currencyPrefix = locale.currency === undefined ? \"\" : locale.currency[0] + \"\",\n      currencySuffix = locale.currency === undefined ? \"\" : locale.currency[1] + \"\",\n      decimal = locale.decimal === undefined ? \".\" : locale.decimal + \"\",\n      numerals = locale.numerals === undefined ? identity : formatNumerals(map.call(locale.numerals, String)),\n      percent = locale.percent === undefined ? \"%\" : locale.percent + \"\",\n      minus = locale.minus === undefined ? \"−\" : locale.minus + \"\",\n      nan = locale.nan === undefined ? \"NaN\" : locale.nan + \"\";\n\n  function newFormat(specifier) {\n    specifier = formatSpecifier(specifier);\n\n    var fill = specifier.fill,\n        align = specifier.align,\n        sign = specifier.sign,\n        symbol = specifier.symbol,\n        zero = specifier.zero,\n        width = specifier.width,\n        comma = specifier.comma,\n        precision = specifier.precision,\n        trim = specifier.trim,\n        type = specifier.type;\n\n    // The \"n\" type is an alias for \",g\".\n    if (type === \"n\") comma = true, type = \"g\";\n\n    // The \"\" type, and any invalid type, is an alias for \".12~g\".\n    else if (!formatTypes[type]) precision === undefined && (precision = 12), trim = true, type = \"g\";\n\n    // If zero fill is specified, padding goes after sign and before digits.\n    if (zero || (fill === \"0\" && align === \"=\")) zero = true, fill = \"0\", align = \"=\";\n\n    // Compute the prefix and suffix.\n    // For SI-prefix, the suffix is lazily computed.\n    var prefix = symbol === \"$\" ? currencyPrefix : symbol === \"#\" && /[boxX]/.test(type) ? \"0\" + type.toLowerCase() : \"\",\n        suffix = symbol === \"$\" ? currencySuffix : /[%p]/.test(type) ? percent : \"\";\n\n    // What format function should we use?\n    // Is this an integer type?\n    // Can this type generate exponential notation?\n    var formatType = formatTypes[type],\n        maybeSuffix = /[defgprs%]/.test(type);\n\n    // Set the default precision if not specified,\n    // or clamp the specified precision to the supported range.\n    // For significant precision, it must be in [1, 21].\n    // For fixed precision, it must be in [0, 20].\n    precision = precision === undefined ? 6\n        : /[gprs]/.test(type) ? Math.max(1, Math.min(21, precision))\n        : Math.max(0, Math.min(20, precision));\n\n    function format(value) {\n      var valuePrefix = prefix,\n          valueSuffix = suffix,\n          i, n, c;\n\n      if (type === \"c\") {\n        valueSuffix = formatType(value) + valueSuffix;\n        value = \"\";\n      } else {\n        value = +value;\n\n        // Determine the sign. -0 is not less than 0, but 1 / -0 is!\n        var valueNegative = value < 0 || 1 / value < 0;\n\n        // Perform the initial formatting.\n        value = isNaN(value) ? nan : formatType(Math.abs(value), precision);\n\n        // Trim insignificant zeros.\n        if (trim) value = formatTrim(value);\n\n        // If a negative value rounds to zero after formatting, and no explicit positive sign is requested, hide the sign.\n        if (valueNegative && +value === 0 && sign !== \"+\") valueNegative = false;\n\n        // Compute the prefix and suffix.\n        valuePrefix = (valueNegative ? (sign === \"(\" ? sign : minus) : sign === \"-\" || sign === \"(\" ? \"\" : sign) + valuePrefix;\n        valueSuffix = (type === \"s\" ? prefixes[8 + prefixExponent / 3] : \"\") + valueSuffix + (valueNegative && sign === \"(\" ? \")\" : \"\");\n\n        // Break the formatted value into the integer “value” part that can be\n        // grouped, and fractional or exponential “suffix” part that is not.\n        if (maybeSuffix) {\n          i = -1, n = value.length;\n          while (++i < n) {\n            if (c = value.charCodeAt(i), 48 > c || c > 57) {\n              valueSuffix = (c === 46 ? decimal + value.slice(i + 1) : value.slice(i)) + valueSuffix;\n              value = value.slice(0, i);\n              break;\n            }\n          }\n        }\n      }\n\n      // If the fill character is not \"0\", grouping is applied before padding.\n      if (comma && !zero) value = group(value, Infinity);\n\n      // Compute the padding.\n      var length = valuePrefix.length + value.length + valueSuffix.length,\n          padding = length < width ? new Array(width - length + 1).join(fill) : \"\";\n\n      // If the fill character is \"0\", grouping is applied after padding.\n      if (comma && zero) value = group(padding + value, padding.length ? width - valueSuffix.length : Infinity), padding = \"\";\n\n      // Reconstruct the final output based on the desired alignment.\n      switch (align) {\n        case \"<\": value = valuePrefix + value + valueSuffix + padding; break;\n        case \"=\": value = valuePrefix + padding + value + valueSuffix; break;\n        case \"^\": value = padding.slice(0, length = padding.length >> 1) + valuePrefix + value + valueSuffix + padding.slice(length); break;\n        default: value = padding + valuePrefix + value + valueSuffix; break;\n      }\n\n      return numerals(value);\n    }\n\n    format.toString = function() {\n      return specifier + \"\";\n    };\n\n    return format;\n  }\n\n  function formatPrefix(specifier, value) {\n    var f = newFormat((specifier = formatSpecifier(specifier), specifier.type = \"f\", specifier)),\n        e = Math.max(-8, Math.min(8, Math.floor(exponent(value) / 3))) * 3,\n        k = Math.pow(10, -e),\n        prefix = prefixes[8 + e / 3];\n    return function(value) {\n      return f(k * value) + prefix;\n    };\n  }\n\n  return {\n    format: newFormat,\n    formatPrefix: formatPrefix\n  };\n}\n","import exponent from \"./exponent.js\";\n\nexport default function(step, max) {\n  step = Math.abs(step), max = Math.abs(max) - step;\n  return Math.max(0, exponent(max) - exponent(step)) + 1;\n}\n","import exponent from \"./exponent.js\";\n\nexport default function(step) {\n  return Math.max(0, -exponent(Math.abs(step)));\n}\n","import {tickStep} from \"d3-array\";\nimport {format, formatPrefix, formatSpecifier, precisionFixed, precisionPrefix, precisionRound} from \"d3-format\";\n\nexport default function tickFormat(start, stop, count, specifier) {\n  var step = tickStep(start, stop, count),\n      precision;\n  specifier = formatSpecifier(specifier == null ? \",f\" : specifier);\n  switch (specifier.type) {\n    case \"s\": {\n      var value = Math.max(Math.abs(start), Math.abs(stop));\n      if (specifier.precision == null && !isNaN(precision = precisionPrefix(step, value))) specifier.precision = precision;\n      return formatPrefix(specifier, value);\n    }\n    case \"\":\n    case \"e\":\n    case \"g\":\n    case \"p\":\n    case \"r\": {\n      if (specifier.precision == null && !isNaN(precision = precisionRound(step, Math.max(Math.abs(start), Math.abs(stop))))) specifier.precision = precision - (specifier.type === \"e\");\n      break;\n    }\n    case \"f\":\n    case \"%\": {\n      if (specifier.precision == null && !isNaN(precision = precisionFixed(step))) specifier.precision = precision - (specifier.type === \"%\") * 2;\n      break;\n    }\n  }\n  return format(specifier);\n}\n","import {ticks, tickIncrement} from \"d3-array\";\nimport continuous, {copy} from \"./continuous.js\";\nimport {initRange} from \"./init.js\";\nimport tickFormat from \"./tickFormat.js\";\n\nexport function linearish(scale) {\n  var domain = scale.domain;\n\n  scale.ticks = function(count) {\n    var d = domain();\n    return ticks(d[0], d[d.length - 1], count == null ? 10 : count);\n  };\n\n  scale.tickFormat = function(count, specifier) {\n    var d = domain();\n    return tickFormat(d[0], d[d.length - 1], count == null ? 10 : count, specifier);\n  };\n\n  scale.nice = function(count) {\n    if (count == null) count = 10;\n\n    var d = domain();\n    var i0 = 0;\n    var i1 = d.length - 1;\n    var start = d[i0];\n    var stop = d[i1];\n    var prestep;\n    var step;\n    var maxIter = 10;\n\n    if (stop < start) {\n      step = start, start = stop, stop = step;\n      step = i0, i0 = i1, i1 = step;\n    }\n    \n    while (maxIter-- > 0) {\n      step = tickIncrement(start, stop, count);\n      if (step === prestep) {\n        d[i0] = start\n        d[i1] = stop\n        return domain(d);\n      } else if (step > 0) {\n        start = Math.floor(start / step) * step;\n        stop = Math.ceil(stop / step) * step;\n      } else if (step < 0) {\n        start = Math.ceil(start * step) / step;\n        stop = Math.floor(stop * step) / step;\n      } else {\n        break;\n      }\n      prestep = step;\n    }\n\n    return scale;\n  };\n\n  return scale;\n}\n\nexport default function linear() {\n  var scale = continuous();\n\n  scale.copy = function() {\n    return copy(scale, linear());\n  };\n\n  initRange.apply(scale, arguments);\n\n  return linearish(scale);\n}\n","var $ = require('../internals/export');\nvar toObject = require('../internals/to-object');\nvar nativeKeys = require('../internals/object-keys');\nvar fails = require('../internals/fails');\n\nvar FAILS_ON_PRIMITIVES = fails(function () { nativeKeys(1); });\n\n// `Object.keys` method\n// https://tc39.github.io/ecma262/#sec-object.keys\n$({ target: 'Object', stat: true, forced: FAILS_ON_PRIMITIVES }, {\n  keys: function keys(it) {\n    return nativeKeys(toObject(it));\n  }\n});\n","var $ = require('../internals/export');\n\nvar ceil = Math.ceil;\nvar floor = Math.floor;\n\n// `Math.trunc` method\n// https://tc39.github.io/ecma262/#sec-math.trunc\n$({ target: 'Math', stat: true }, {\n  trunc: function trunc(it) {\n    return (it > 0 ? floor : ceil)(it);\n  }\n});\n","<template>\r\n<div>\r\n  <svg id=\"emotional-wordle-edit-svg\"\r\n             :height=\"styleScheme.height\"\r\n            :width=\"styleScheme.width\"\r\n            :viewBox=\"`0 0 ${styleScheme.width} ${styleScheme.height}`\"\r\n            preserveAspectRatio=\"xMidYMid meet\"\r\n            ></svg>\r\n  <div\r\n    class=\"canvas-container\"\r\n    :style=\"{ height: styleScheme.height + 'px', 'text-align': 'center' }\"\r\n  >\r\n    <canvas id=\"emotional-wordle-canvas\"></canvas>\r\n    <!-- <canvas id=\"emotional-wordle-bg-canvas\"></canvas> -->\r\n  </div>\r\n  </div>\r\n</template>\r\n<script lang=\"ts\">\r\n/* eslint-disable */\r\n\r\nimport { Vue } from \"vue-class-component\"\r\nimport { CloudManager } from \"@/assets/cloud\"\r\nimport { Dataset, Mode, Style, Word } from '@/assets/types'\r\nimport * as ColorPreset from \"@/assets/color-preset\"\r\nimport * as d3 from \"d3-fetch\"\r\n\r\n\r\nexport default class ShakingView extends Vue {\r\n  public wordleData: Word[] = []\r\n  public collection: Dataset[] = []\r\n  public fileReader = new FileReader()\r\n  public uploadFilename: string = \"\"\r\n  public animationModes: Array<Mode> = [Mode.bubble, Mode.colorful, Mode.chill, Mode.glisten, Mode.electric]\r\n  public animationMode: Mode = Mode.bubble\r\n  public fontFamily = 'NotoSans'\r\n  public fontStyle = 'normal'\r\n  public fontWeight = 'normal'\r\n  public colorSchemes = ['red', 'black', 'Viridis', 'Plasma', 'rainbow']\r\n  public colorScheme = 'red'\r\n  public easeTypes = ['Cubic', 'ElasticIn', 'ElasticOut', 'BounceIn', 'BounceOut', 'BounceInOut']\r\n  public easeType = 'ElasticIn'\r\n  public strokeWidth = '2px'\r\n  public rotation: number = 0\r\n  public duration: number = 10000\r\n  public cloudManager: CloudManager | undefined\r\n  public customColor = \"#000000\"\r\n  public presetColors = ColorPreset.rainbow\r\n  public bgAnimator: any\r\n  get styleScheme ():Style {\r\n    return {\r\n      colorScheme: this.colorScheme,\r\n      fontStyle: this.fontStyle,\r\n      fontWeight: this.fontWeight,\r\n      fontFamily: this.fontFamily,\r\n      strokeWidth: this.strokeWidth,\r\n      rotation: this.rotation,\r\n      height: 520,\r\n      width: 800\r\n    }\r\n  }\r\n\r\n  mounted() {\r\n    let url = './dataset/layout/layout_xmas.json'\r\n    d3.json(url).then((d: any) => {\r\n        this.wordleData = d as Word[]\r\n        this.cloudManager = new CloudManager(this.wordleData, \r\n                                            this.styleScheme, \r\n                                            this.animationMode,\r\n                                            'emotional-wordle-svg',\r\n                                            'emotional-wordle-canvas',\r\n                                            this.bgAnimator,\r\n                                            true,\r\n                                            false,\r\n                                            this.duration\r\n                                            )\r\n      this.cloudManager.animator?.createGif()                 \r\n      this.cloudManager.animator?.play()\r\n      }, (err: any) => {\r\n      console.log(err)\r\n    })\r\n    \r\n  }\r\n}\r\n\r\n</script>\r\n<style lang=\"scss\" scoped>\r\n@import \"../assets/scss/_ui.scss\";\r\n// @keyframes float {\r\n//   0% {\r\n//     box-shadow: 0 5px 15px 0px rgba(0, 0, 0, 0.6);\r\n//     transform: translatey(0px);\r\n//   }\r\n//   50% {\r\n//     box-shadow: 0 25px 15px 0px rgba(0, 0, 0, 0.2);\r\n//     transform: translatey(-20px);\r\n//   }\r\n//   100% {\r\n//     box-shadow: 0 5px 15px 0px rgba(0, 0, 0, 0.6);\r\n//     transform: translatey(0px);\r\n//   }\r\n// }\r\n.text-canvas {\r\n  stroke-width: 0;\r\n  fill-opacity: 0;\r\n  stroke: black;\r\n  &.active {\r\n    stroke-width: 1px;\r\n     &.activate {\r\n        stroke: orange;\r\n      }\r\n  }\r\n}\r\n\r\n</style>\r\n","\r\n/* eslint-disable */\r\n\r\nimport { Vue } from \"vue-class-component\"\r\nimport { CloudManager } from \"@/assets/cloud\"\r\nimport { Dataset, Mode, Style, Word } from '@/assets/types'\r\nimport * as ColorPreset from \"@/assets/color-preset\"\r\nimport * as d3 from \"d3-fetch\"\r\n\r\n\r\nexport default class ShakingView extends Vue {\r\n  public wordleData: Word[] = []\r\n  public collection: Dataset[] = []\r\n  public fileReader = new FileReader()\r\n  public uploadFilename: string = \"\"\r\n  public animationModes: Array<Mode> = [Mode.bubble, Mode.colorful, Mode.chill, Mode.glisten, Mode.electric]\r\n  public animationMode: Mode = Mode.bubble\r\n  public fontFamily = 'NotoSans'\r\n  public fontStyle = 'normal'\r\n  public fontWeight = 'normal'\r\n  public colorSchemes = ['red', 'black', 'Viridis', 'Plasma', 'rainbow']\r\n  public colorScheme = 'red'\r\n  public easeTypes = ['Cubic', 'ElasticIn', 'ElasticOut', 'BounceIn', 'BounceOut', 'BounceInOut']\r\n  public easeType = 'ElasticIn'\r\n  public strokeWidth = '2px'\r\n  public rotation: number = 0\r\n  public duration: number = 10000\r\n  public cloudManager: CloudManager | undefined\r\n  public customColor = \"#000000\"\r\n  public presetColors = ColorPreset.rainbow\r\n  public bgAnimator: any\r\n  get styleScheme ():Style {\r\n    return {\r\n      colorScheme: this.colorScheme,\r\n      fontStyle: this.fontStyle,\r\n      fontWeight: this.fontWeight,\r\n      fontFamily: this.fontFamily,\r\n      strokeWidth: this.strokeWidth,\r\n      rotation: this.rotation,\r\n      height: 520,\r\n      width: 800\r\n    }\r\n  }\r\n\r\n  mounted() {\r\n    let url = './dataset/layout/layout_xmas.json'\r\n    d3.json(url).then((d: any) => {\r\n        this.wordleData = d as Word[]\r\n        this.cloudManager = new CloudManager(this.wordleData, \r\n                                            this.styleScheme, \r\n                                            this.animationMode,\r\n                                            'emotional-wordle-svg',\r\n                                            'emotional-wordle-canvas',\r\n                                            this.bgAnimator,\r\n                                            true,\r\n                                            false,\r\n                                            this.duration\r\n                                            )\r\n      this.cloudManager.animator?.createGif()                 \r\n      this.cloudManager.animator?.play()\r\n      }, (err: any) => {\r\n      console.log(err)\r\n    })\r\n    \r\n  }\r\n}\r\n\r\n","import { render } from \"./Shaking.vue?vue&type=template&id=62e83a68&scoped=true\"\nimport script from \"./Shaking.vue?vue&type=script&lang=ts\"\nexport * from \"./Shaking.vue?vue&type=script&lang=ts\"\n\nimport \"./Shaking.vue?vue&type=style&index=0&id=62e83a68&lang=scss&scoped=true\"\nscript.render = render\nscript.__scopeId = \"data-v-62e83a68\"\n\nexport default script","/* eslint-disable */\r\n/**\r\n * doc comment for cloud.ts\r\n * control the layout for words based on their size and font\r\n * @packageDocumentation\r\n */\r\nimport cloudGenerator from 'd3-cloud'\r\nimport * as scale from 'd3-scale'\r\nimport { PlotHandler } from './plot'\r\nimport { WordleAnimator } from './animator'\r\nimport { Word, Style, Mode } from \"@/assets/types\"\r\n\r\nclass CloudManager {\r\n    public canvasHandler: PlotHandler\r\n    // public animator: Animator | undefined\r\n    public animator: WordleAnimator | undefined\r\n    constructor(data: Word[],\r\n                styleSheet: Style,\r\n                mode: Mode = Mode.bubble,\r\n                svgid: string = 'emotional-wordle-svg', \r\n                canvasid: string = 'emotional-wordle-canvas',\r\n                bgAnimator: Generator<any, void, any>,\r\n                loadCanvasFlag: boolean = true,\r\n                loadSvgFlag: boolean = true,\r\n                duration: number = 2000\r\n                ) {\r\n        this.canvasHandler = new PlotHandler(canvasid, svgid, styleSheet, loadCanvasFlag)\r\n        let self = this\r\n        // console.log(data, 'cloud data')\r\n        if(loadCanvasFlag) {\r\n            self.animator = new WordleAnimator({\r\n                data: assignColor(data), \r\n                plotHandler: self.canvasHandler, \r\n                duration: duration\r\n            })\r\n            // self.animator = new Animator(data, self.canvasHandler, duration, bgAnimator)\r\n            // self.animator.play()\r\n        }\r\n        else if (loadSvgFlag) {\r\n            testCloud(data, styleSheet)\r\n            .on('end', function (words: cloudGenerator.Word[]) {\r\n                let finalData = words as Word[]\r\n                  self.canvasHandler.plotOnSvgWithConfig(finalData)\r\n            })\r\n        }\r\n    }\r\n    public play(duration: number=2000) {\r\n        if (!this.animator) return\r\n        this.animator!.update('duration', duration)\r\n        this.animator!.stop()\r\n        this.animator!.play()\r\n        return this\r\n    }\r\n    public stop() {\r\n        this.animator!.stop()\r\n        return this\r\n    }\r\n    public updateMode(mode: Mode) {\r\n        this.animator!.update('mode', mode)\r\n    }\r\n}\r\nlet testCloud = function (data: Word[], styleSheet: Style) {\r\n    let width = styleSheet.width\r\n    let height = styleSheet.height\r\n    let wordScale = scale.scaleLinear()\r\n        .domain([0, 75])  // !!!!!!!!!!!!!!!!!!!!!!!\r\n        .range([10, 120]) // !!!!!!!!!!!!!!!!!!!!!!!\r\n    return cloudGenerator()\r\n        .size([width, height])\r\n        .timeInterval(200)\r\n        .words(data)\r\n        .rotate(styleSheet.rotation!) //function(d) { return 0 }\r\n        .fontSize((d: cloudGenerator.Word, idx: number) => {\r\n            let word = d as Word\r\n            return wordScale(word.frequency)\r\n        })\r\n        .font(styleSheet.fontFamily!)\r\n        .fontStyle(styleSheet.fontStyle!)\r\n        .fontWeight(styleSheet.fontWeight!)\r\n        .text((d: cloudGenerator.Word, idx: number)=> {\r\n            return d.text || ''\r\n        })\r\n        .spiral(styleSheet.spiralType!) // 'archimedean' or 'rectangular'\r\n        .start()\r\n}\r\n\r\nfunction assignColor(words: Word[]) {\r\n    words.forEach((word: Word, idx: number) => {\r\n        word.color = 'black'\r\n    })\r\n    return words\r\n}\r\n\r\nexport {\r\n    CloudManager\r\n}\r\n","export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../node_modules/vue-loader-v16/dist/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader-v16/dist/index.js??ref--0-1!./Shaking.vue?vue&type=style&index=0&id=62e83a68&lang=scss&scoped=true\"","var $ = require('../internals/export');\nvar DESCRIPTORS = require('../internals/descriptors');\nvar ownKeys = require('../internals/own-keys');\nvar toIndexedObject = require('../internals/to-indexed-object');\nvar getOwnPropertyDescriptorModule = require('../internals/object-get-own-property-descriptor');\nvar createProperty = require('../internals/create-property');\n\n// `Object.getOwnPropertyDescriptors` method\n// https://tc39.github.io/ecma262/#sec-object.getownpropertydescriptors\n$({ target: 'Object', stat: true, sham: !DESCRIPTORS }, {\n  getOwnPropertyDescriptors: function getOwnPropertyDescriptors(object) {\n    var O = toIndexedObject(object);\n    var getOwnPropertyDescriptor = getOwnPropertyDescriptorModule.f;\n    var keys = ownKeys(O);\n    var result = {};\n    var index = 0;\n    var key, descriptor;\n    while (keys.length > index) {\n      descriptor = getOwnPropertyDescriptor(O, key = keys[index++]);\n      if (descriptor !== undefined) createProperty(result, key, descriptor);\n    }\n    return result;\n  }\n});\n","var $ = require('../internals/export');\nvar fails = require('../internals/fails');\nvar toIndexedObject = require('../internals/to-indexed-object');\nvar nativeGetOwnPropertyDescriptor = require('../internals/object-get-own-property-descriptor').f;\nvar DESCRIPTORS = require('../internals/descriptors');\n\nvar FAILS_ON_PRIMITIVES = fails(function () { nativeGetOwnPropertyDescriptor(1); });\nvar FORCED = !DESCRIPTORS || FAILS_ON_PRIMITIVES;\n\n// `Object.getOwnPropertyDescriptor` method\n// https://tc39.github.io/ecma262/#sec-object.getownpropertydescriptor\n$({ target: 'Object', stat: true, forced: FORCED, sham: !DESCRIPTORS }, {\n  getOwnPropertyDescriptor: function getOwnPropertyDescriptor(it, key) {\n    return nativeGetOwnPropertyDescriptor(toIndexedObject(it), key);\n  }\n});\n","import {tpmt} from \"./math.js\";\n\nexport function expIn(t) {\n  return tpmt(1 - +t);\n}\n\nexport function expOut(t) {\n  return 1 - tpmt(t);\n}\n\nexport function expInOut(t) {\n  return ((t *= 2) <= 1 ? tpmt(1 - t) : 2 - tpmt(t - 1)) / 2;\n}\n","export const radians = Math.PI / 180;\nexport const degrees = 180 / Math.PI;\n","import define, {extend} from \"./define.js\";\nimport {Color, rgbConvert, Rgb} from \"./color.js\";\nimport {degrees, radians} from \"./math.js\";\n\n// https://observablehq.com/@mbostock/lab-and-rgb\nconst K = 18,\n    Xn = 0.96422,\n    Yn = 1,\n    Zn = 0.82521,\n    t0 = 4 / 29,\n    t1 = 6 / 29,\n    t2 = 3 * t1 * t1,\n    t3 = t1 * t1 * t1;\n\nfunction labConvert(o) {\n  if (o instanceof Lab) return new Lab(o.l, o.a, o.b, o.opacity);\n  if (o instanceof Hcl) return hcl2lab(o);\n  if (!(o instanceof Rgb)) o = rgbConvert(o);\n  var r = rgb2lrgb(o.r),\n      g = rgb2lrgb(o.g),\n      b = rgb2lrgb(o.b),\n      y = xyz2lab((0.2225045 * r + 0.7168786 * g + 0.0606169 * b) / Yn), x, z;\n  if (r === g && g === b) x = z = y; else {\n    x = xyz2lab((0.4360747 * r + 0.3850649 * g + 0.1430804 * b) / Xn);\n    z = xyz2lab((0.0139322 * r + 0.0971045 * g + 0.7141733 * b) / Zn);\n  }\n  return new Lab(116 * y - 16, 500 * (x - y), 200 * (y - z), o.opacity);\n}\n\nexport function gray(l, opacity) {\n  return new Lab(l, 0, 0, opacity == null ? 1 : opacity);\n}\n\nexport default function lab(l, a, b, opacity) {\n  return arguments.length === 1 ? labConvert(l) : new Lab(l, a, b, opacity == null ? 1 : opacity);\n}\n\nexport function Lab(l, a, b, opacity) {\n  this.l = +l;\n  this.a = +a;\n  this.b = +b;\n  this.opacity = +opacity;\n}\n\ndefine(Lab, lab, extend(Color, {\n  brighter: function(k) {\n    return new Lab(this.l + K * (k == null ? 1 : k), this.a, this.b, this.opacity);\n  },\n  darker: function(k) {\n    return new Lab(this.l - K * (k == null ? 1 : k), this.a, this.b, this.opacity);\n  },\n  rgb: function() {\n    var y = (this.l + 16) / 116,\n        x = isNaN(this.a) ? y : y + this.a / 500,\n        z = isNaN(this.b) ? y : y - this.b / 200;\n    x = Xn * lab2xyz(x);\n    y = Yn * lab2xyz(y);\n    z = Zn * lab2xyz(z);\n    return new Rgb(\n      lrgb2rgb( 3.1338561 * x - 1.6168667 * y - 0.4906146 * z),\n      lrgb2rgb(-0.9787684 * x + 1.9161415 * y + 0.0334540 * z),\n      lrgb2rgb( 0.0719453 * x - 0.2289914 * y + 1.4052427 * z),\n      this.opacity\n    );\n  }\n}));\n\nfunction xyz2lab(t) {\n  return t > t3 ? Math.pow(t, 1 / 3) : t / t2 + t0;\n}\n\nfunction lab2xyz(t) {\n  return t > t1 ? t * t * t : t2 * (t - t0);\n}\n\nfunction lrgb2rgb(x) {\n  return 255 * (x <= 0.0031308 ? 12.92 * x : 1.055 * Math.pow(x, 1 / 2.4) - 0.055);\n}\n\nfunction rgb2lrgb(x) {\n  return (x /= 255) <= 0.04045 ? x / 12.92 : Math.pow((x + 0.055) / 1.055, 2.4);\n}\n\nfunction hclConvert(o) {\n  if (o instanceof Hcl) return new Hcl(o.h, o.c, o.l, o.opacity);\n  if (!(o instanceof Lab)) o = labConvert(o);\n  if (o.a === 0 && o.b === 0) return new Hcl(NaN, 0 < o.l && o.l < 100 ? 0 : NaN, o.l, o.opacity);\n  var h = Math.atan2(o.b, o.a) * degrees;\n  return new Hcl(h < 0 ? h + 360 : h, Math.sqrt(o.a * o.a + o.b * o.b), o.l, o.opacity);\n}\n\nexport function lch(l, c, h, opacity) {\n  return arguments.length === 1 ? hclConvert(l) : new Hcl(h, c, l, opacity == null ? 1 : opacity);\n}\n\nexport function hcl(h, c, l, opacity) {\n  return arguments.length === 1 ? hclConvert(h) : new Hcl(h, c, l, opacity == null ? 1 : opacity);\n}\n\nexport function Hcl(h, c, l, opacity) {\n  this.h = +h;\n  this.c = +c;\n  this.l = +l;\n  this.opacity = +opacity;\n}\n\nfunction hcl2lab(o) {\n  if (isNaN(o.h)) return new Lab(o.l, 0, 0, o.opacity);\n  var h = o.h * radians;\n  return new Lab(o.l, Math.cos(h) * o.c, Math.sin(h) * o.c, o.opacity);\n}\n\ndefine(Hcl, hcl, extend(Color, {\n  brighter: function(k) {\n    return new Hcl(this.h, this.c, this.l + K * (k == null ? 1 : k), this.opacity);\n  },\n  darker: function(k) {\n    return new Hcl(this.h, this.c, this.l - K * (k == null ? 1 : k), this.opacity);\n  },\n  rgb: function() {\n    return hcl2lab(this).rgb();\n  }\n}));\n","import {hcl as colorHcl} from \"d3-color\";\nimport color, {hue} from \"./color.js\";\n\nfunction hcl(hue) {\n  return function(start, end) {\n    var h = hue((start = colorHcl(start)).h, (end = colorHcl(end)).h),\n        c = color(start.c, end.c),\n        l = color(start.l, end.l),\n        opacity = color(start.opacity, end.opacity);\n    return function(t) {\n      start.h = h(t);\n      start.c = c(t);\n      start.l = l(t);\n      start.opacity = opacity(t);\n      return start + \"\";\n    };\n  }\n}\n\nexport default hcl(hue);\nexport var hclLong = hcl(color);\n","/* eslint-disable */\r\n/**\r\n * doc comment for manual.ts\r\n * @remarks \r\n * Manual attempts for animation effects.\r\n * @packageDocumentation\r\n */\r\n\r\nimport * as Color from \"@/assets/color-preset\"\r\nimport { GroupManager, KeyFrame } from \"@/assets/animator\"\r\nimport { KeyframeConfig } from \"@/assets/types\"\r\nimport * as d3Ease from \"d3-ease\"\r\n\r\nexport let colorTransition = function () {\r\n     let keyframes = [] as Array<KeyFrame>\r\n     let colors = Color.calm;\r\n     colors.forEach((c, idx) => {\r\n        keyframes.push(new KeyFrame({\r\n            'color': c,\r\n            'stage': Math.ceil((idx) * 100/(colors.length-1))\r\n        }))\r\n     })\r\n     return keyframes\r\n}\r\n\r\n// I found it only works as a function or there will be import error\r\nexport let coloredShake = () => [\r\n        new KeyFrame({ xoff: -1, yoff: -1, color: 'red', stage: 0 }),\r\n        new KeyFrame({ xoff: 0, yoff: 0, color: 'yellow', stage: 20 }),\r\n        new KeyFrame({ xoff: -1, yoff: 1, color: 'blue', stage: 60 }),\r\n        new KeyFrame({ xoff: 0, yoff: 0, color: 'grey', stage: 80 }),\r\n        new KeyFrame({ xoff: 1, yoff: 1, color: 'green', stage: 100 })\r\n        // new KeyFrame({ xoff: -1, yoff: 1 }),\r\n        // new KeyFrame({ xoff: -1, yoff: -1 }),\r\n        // new KeyFrame({ xoff: 1, yoff: -1 }),\r\n        // new KeyFrame({ xoff: 0, yoff: 1 }),\r\n    ]\r\n\r\nexport let smallShake = () => [\r\n        new KeyFrame({ xoff: 0, yoff: 0, stage: 0 }),\r\n        new KeyFrame({ xoff: 0.5, yoff: 0.5, stage: 5 }),\r\n        new KeyFrame({ xoff: 0, yoff: 0, stage: 10 }),\r\n        new KeyFrame({ xoff: -0.5, yoff: 0, stage: 15 }),\r\n        new KeyFrame({ xoff: 0, yoff: 0, stage: 20 }),\r\n        new KeyFrame({ xoff: 0.5, yoff: -0.5, stage: 25 }),\r\n        new KeyFrame({ xoff: 1, yoff: 0, stage: 100 })\r\n    ]\r\n\r\nexport let shakeNRotate = () => [\r\n        new KeyFrame({ xoff: 1, yoff: 0, rotate: 5, stage: 0 }),\r\n        new KeyFrame({ xoff: 1, yoff: 0 , rotate: 5, stage: 10}),\r\n        new KeyFrame({ xoff: 0, yoff: 0, rotate: -5, stage: 20 }),\r\n        new KeyFrame({ xoff: -1, yoff: 1, rotate: 5, stage: 30 }),\r\n        new KeyFrame({ xoff: -1, yoff: 0, rotate: -5, stage: 40 }),\r\n        new KeyFrame({ xoff: 0, yoff: 0, rotate: -5, stage: 50 }),\r\n        new KeyFrame({ xoff: -1, yoff: -1, rotate: 5, stage: 60 }),\r\n        new KeyFrame({ xoff: 0, yoff: 0, rotate: -5, stage: 100 })\r\n    ]\r\n\r\nexport let scale = () => [\r\n        new KeyFrame({ scale: 0.5 }),\r\n        new KeyFrame({ scale: 1.5 }),\r\n        new KeyFrame({ scale: 1.0 })\r\n]\r\n\r\nexport let xmas = () =>   [\r\n    new KeyFrame({ xoff: -1, yoff: -1, color: '#FF000000', stage: 0}),\r\n    new KeyFrame({ xoff: -1, yoff: 1, color: '#FF0000', stage: 10}),\r\n    new KeyFrame({ xoff: 1, yoff: 1, color: '#FF0000', stage: 20}),\r\n    new KeyFrame({ xoff: 2, yoff: 2, color: 'white', stage: 30}),\r\n    new KeyFrame({ xoff: 1, yoff: -2, color: 'white', stage: 40}),\r\n    new KeyFrame({ xoff: -1, yoff: -2, color: '#FF8F39', stage: 50}),\r\n    new KeyFrame({ xoff: 3, yoff: -3, color: '#FF8F39', stage: 60}),\r\n    new KeyFrame({ xoff: 2, yoff: 2, color: 'red', stage: 70}),\r\n    new KeyFrame({ xoff: 1, yoff: 1, color: 'red', stage: 80}),\r\n    new KeyFrame({ xoff: -1, yoff: -1, color: '#FF8F39', stage: 90}),\r\n    new KeyFrame({ xoff: 1, yoff: 0, color: '#FF8F39', stage: 100})\r\n]\r\n\r\nexport let split = function () {\r\n    \r\n}\r\n\r\nexport let hardCodeGroups = function () {\r\n     let groupManager: GroupManager[] = [\r\n            new GroupManager({\r\n                duration: 500,\r\n                keyFrames: xmas()\r\n            }),\r\n        ]\r\n        // hasty?\r\n        // let groupManager: GroupManager[] = [\r\n        //     new GroupManager({\r\n        //         duration: 2000,\r\n        //         keyFrames: [\r\n        //             new KeyFrame({ xoff: 0, stage: 0}),\r\n        //             new KeyFrame({ xoff: 1000, stage: 100, color: 'red'}),\r\n\r\n        //         ],\r\n        //     }),\r\n        //     new GroupManager({\r\n        //         duration: 2100,\r\n        //         keyFrames: [\r\n        //             new KeyFrame({ xoff: 0, stage: 0}),\r\n        //             new KeyFrame({ xoff: 1000, stage: 100}),\r\n\r\n        //         ],\r\n        //     }),\r\n        //     new GroupManager({\r\n        //         duration: 2200,\r\n        //         keyFrames: [\r\n        //             new KeyFrame({ xoff: 0, stage: 0}),\r\n        //             new KeyFrame({ xoff: 1000, stage: 100}),\r\n\r\n        //         ],\r\n        //     }),\r\n        //     new GroupManager({\r\n        //         duration: 2300,\r\n        //         keyFrames: [\r\n        //             new KeyFrame({ xoff: 0, stage: 0}),\r\n        //             new KeyFrame({ xoff: 1000, stage: 100}),\r\n\r\n        //         ],\r\n        //     }),\r\n        //     new GroupManager({\r\n        //         duration: 2400,\r\n        //         keyFrames: [\r\n        //             new KeyFrame({ xoff: 0, stage: 0}),\r\n        //             new KeyFrame({ xoff: 1000, stage: 100}),\r\n\r\n        //         ],\r\n        //     }),\r\n        //     new GroupManager({\r\n        //         duration: 2500,\r\n        //         keyFrames: [\r\n        //             new KeyFrame({ xoff: 0, stage: 0}),\r\n        //             new KeyFrame({ xoff: 1000, stage: 100}),\r\n\r\n        //         ],\r\n        //     }),\r\n        //     new GroupManager({\r\n        //         duration: 2600,\r\n        //         keyFrames: [\r\n        //             new KeyFrame({ xoff: 0, stage: 0}),\r\n        //             new KeyFrame({ xoff: 1000, stage: 100}),\r\n\r\n        //         ],\r\n        //     }),\r\n        //     new GroupManager({\r\n        //         duration: 2700,\r\n        //         keyFrames: [\r\n        //             new KeyFrame({ xoff: 0, stage: 0}),\r\n        //             new KeyFrame({ xoff: 1000, stage: 100}),\r\n\r\n        //         ],\r\n        //     }),\r\n        // ]\r\n        // bubbly effect\r\n        // let groupManager: GroupManager[] = [\r\n        //     new GroupManager({\r\n        //         duration: 3000,\r\n        //         keyFrames: [\r\n        //             new KeyFrame({ scale: 0.5, stage: 0, color: 'gold' }),\r\n        //             new KeyFrame({ scale: 1.25, stage: 100, color: 'red' }),\r\n\r\n        //         ]\r\n        //     }),\r\n        //     new GroupManager({\r\n        //         duration: 4000,\r\n        //         keyFrames: [\r\n        //             new KeyFrame({ scale: 0.5, stage: 0, color: 'red' }),\r\n        //             new KeyFrame({ scale: 1.125, stage: 100, color: 'green' }),\r\n\r\n        //         ]\r\n        //     }),\r\n        //     new GroupManager({\r\n        //         duration: 3500,\r\n        //         keyFrames: [\r\n        //             new KeyFrame({ scale: 0.5, stage: 0, color: 'green' }),\r\n        //             new KeyFrame({ scale: 1.3, stage: 100, color: 'gold' }),\r\n\r\n        //         ]\r\n        //     }),\r\n        // ] \r\n        // fly away        \r\n        // let groupManager: GroupManager[] = [\r\n        //     new GroupManager({\r\n        //         duration: 3000,\r\n        //         keyFrames: [\r\n        //             new KeyFrame({rotate: 0, stage: 0}),\r\n        //             new KeyFrame({xoff: 200, yoff: -200, scale: 0, rotate: 720, stage: 100}),\r\n\r\n        //         ]\r\n        //     }),\r\n        //     new GroupManager({\r\n        //         duration: 2000,\r\n        //         keyFrames: [\r\n        //             new KeyFrame({rotate: 0, stage: 0}),\r\n        //             new KeyFrame({xoff: 200, yoff: -200, scale: 0, rotate: 720, stage: 100}),\r\n\r\n        //         ]\r\n        //     }),\r\n        //     new GroupManager({\r\n        //         duration: 2100,\r\n        //         keyFrames: [\r\n        //             new KeyFrame({rotate: 0, stage: 0}),\r\n        //             new KeyFrame({xoff: 200, yoff: -200, scale: 0, rotate: 720, stage: 100}),\r\n\r\n        //         ]\r\n        //     }),\r\n        //     new GroupManager({\r\n        //         duration: 2400,\r\n        //         keyFrames: [\r\n        //             new KeyFrame({rotate: 0, stage: 0}),\r\n        //             new KeyFrame({xoff: 200, yoff: -200, scale: 0, rotate: 720, stage: 100}),\r\n\r\n        //         ]\r\n        //     })\r\n        // ]\r\n        // slide away\r\n        //  let groupManager: GroupManager[] = [\r\n        //     new GroupManager({\r\n        //         duration: 3000,\r\n        //         keyFrames: [\r\n        //             new KeyFrame({xoff: 0, stage: 0}),\r\n        //             new KeyFrame({xoff: 1500, scale: 0, stage: 100, color: '#C1C1C1'}),\r\n\r\n        //         ]\r\n        //     }),\r\n        // ]\r\n        // inception style?\r\n        //  let groupManager: GroupManager[] = [\r\n        //     new GroupManager({\r\n        //         ease: d3Ease.easeLinear,\r\n        //         duration: 3000,\r\n        //         keyFrames: [\r\n        //             new KeyFrame({xoff: 0, stage: 0}),\r\n        //             new KeyFrame({xoff: 0, scale: 0, stage: 100}),\r\n        //         ]\r\n        //     }),\r\n        //     new GroupManager({\r\n        //         ease: d3Ease.easeLinear,\r\n        //         duration: 2250,\r\n        //         keyFrames: [\r\n        //             new KeyFrame({xoff: 0, stage: 0}),\r\n        //             new KeyFrame({xoff: 0, scale: 0, stage: 100}),\r\n        //         ]\r\n        //     }),\r\n        //     new GroupManager({\r\n        //         ease: d3Ease.easeLinear,\r\n        //         duration: 2000,\r\n        //         keyFrames: [\r\n        //             new KeyFrame({xoff: 0, stage: 0}),\r\n        //             new KeyFrame({xoff: 0, scale: 0, stage: 100}),\r\n        //         ]\r\n        //     }),\r\n        //     new GroupManager({\r\n        //         ease: d3Ease.easeLinear,\r\n        //         duration: 2500,\r\n        //         keyFrames: [\r\n        //             new KeyFrame({xoff: 0, stage: 0}),\r\n        //             new KeyFrame({xoff: 0, scale: 0, stage: 100}),\r\n        //         ]\r\n        //     }),\r\n        //     new GroupManager({\r\n        //         ease: d3Ease.easeLinear,\r\n        //         duration: 2600,\r\n        //         keyFrames: [\r\n        //             new KeyFrame({xoff: 0, stage: 0}),\r\n        //             new KeyFrame({xoff: 0, scale: 0, stage: 100}),\r\n        //         ]\r\n        //     }),\r\n        //     new GroupManager({\r\n        //         ease: d3Ease.easeLinear,\r\n        //         duration: 2400,\r\n        //         keyFrames: [\r\n        //             new KeyFrame({xoff: 0, stage: 0}),\r\n        //             new KeyFrame({xoff: 0, scale: 0, stage: 100}),\r\n        //         ]\r\n        //     }),\r\n        //     new GroupManager({\r\n        //         ease: d3Ease.easeLinear,\r\n        //         duration: 2700,\r\n        //         keyFrames: [\r\n        //             new KeyFrame({xoff: 0, stage: 0}),\r\n        //             new KeyFrame({xoff: 0, scale: 0, stage: 100}),\r\n        //         ]\r\n        //     }),\r\n        // ]\r\n        // rotation with colorization\r\n        // let groupManager: GroupManager[] = [\r\n        //         new GroupManager({\r\n        //             ease: d3Ease.easeSin,\r\n        //             duration: 3000,\r\n        //             keyFrames: [\r\n        //                 new KeyFrame({xoff: 0, stage: 0}),\r\n        //                 new KeyFrame({xoff: 0, rotate: 720, color:'#0CB04A', stage: 100}),\r\n        //             ]\r\n        //         }),\r\n        //         new GroupManager({\r\n        //             ease: d3Ease.easeCircle,\r\n        //             duration: 3000,\r\n        //             keyFrames: [\r\n        //                 new KeyFrame({xoff: 0, stage: 0}),\r\n        //                 new KeyFrame({xoff: 0, rotate: 360, color:'#0A7533', stage: 100}),\r\n        //             ]\r\n        //         }),\r\n        //         new GroupManager({\r\n        //             ease: d3Ease.easeCubic,\r\n        //             duration: 3000,\r\n        //             keyFrames: [\r\n        //                 new KeyFrame({xoff: 0, stage: 0}),\r\n        //                 new KeyFrame({xoff: 0, rotate: 1080, color: '#FF3A2F', stage: 100}),\r\n        //             ]\r\n        //         }),\r\n        //         new GroupManager({\r\n        //             ease: d3Ease.easePoly,\r\n        //             duration: 3000,\r\n        //             keyFrames: [\r\n        //                 new KeyFrame({xoff: 0, stage: 0}),\r\n        //                 new KeyFrame({xoff: 0, rotate: 1440, color: '#A92921', stage: 100}),\r\n        //             ]\r\n        //         }),\r\n        //     ]\r\n    return groupManager\r\n}","import defineProperty from \"@babel/runtime/helpers/esm/defineProperty\";\n\nfunction ownKeys(object, enumerableOnly) {\n  var keys = Object.keys(object);\n\n  if (Object.getOwnPropertySymbols) {\n    var symbols = Object.getOwnPropertySymbols(object);\n    if (enumerableOnly) symbols = symbols.filter(function (sym) {\n      return Object.getOwnPropertyDescriptor(object, sym).enumerable;\n    });\n    keys.push.apply(keys, symbols);\n  }\n\n  return keys;\n}\n\nexport default function _objectSpread2(target) {\n  for (var i = 1; i < arguments.length; i++) {\n    var source = arguments[i] != null ? arguments[i] : {};\n\n    if (i % 2) {\n      ownKeys(Object(source), true).forEach(function (key) {\n        defineProperty(target, key, source[key]);\n      });\n    } else if (Object.getOwnPropertyDescriptors) {\n      Object.defineProperties(target, Object.getOwnPropertyDescriptors(source));\n    } else {\n      ownKeys(Object(source)).forEach(function (key) {\n        Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key));\n      });\n    }\n  }\n\n  return target;\n}","/* eslint-disable */\r\n\r\nimport { KeyFrame } from \"./animator\";\r\nimport * as Manual from \"@/assets/manual\";\r\nimport { Mode } from \"@/assets/types\"\r\nimport { FontConfig } from \"@/assets/variable-font\"\r\n\r\nconst minNumGroup = 1;\r\nconst sampleFont = new FontConfig()\r\nconst sampleItalic = sampleFont.italicRange\r\nconst sampleWeight = sampleFont.weightRange\r\nconst sampleItalicInterval = sampleItalic[1] - sampleItalic[0]\r\nconst sampleWeightInterval = sampleWeight[1] - sampleWeight[0]\r\nconst sampleItalicMid = ( sampleItalic[1] + sampleItalic[0] ) / 2\r\nconst sampleWeightMid = ( sampleWeight[1] + sampleWeight[0] ) / 2\r\n\r\nclass KeyFrameHandler {\r\n    public getKeyFrames(mode: Mode, wordLength: number, speed: number, entropy: number, alpha=0) {\r\n        let keyFrames = [] as KeyFrame[][];\r\n        if (mode == Mode.dance) {\r\n            keyFrames = this.getDiscoKeyFrames(wordLength, speed, entropy);\r\n        } else if (mode == Mode.split) {\r\n            keyFrames = this.getSplitKeyframes(wordLength, speed, entropy, alpha)\r\n        } else if (mode == Mode.swing) {\r\n            keyFrames = this.getSwingingKeyFrames(wordLength, speed, entropy)\r\n        }\r\n        else {\r\n            keyFrames = [Manual.colorTransition()];\r\n        }\r\n        return keyFrames;\r\n    }\r\n\r\n    private getSwingingKeyFrames(wordLength: number, speed: number, entropy: number) {\r\n        let keyFrames = [] as KeyFrame[][];\r\n        const maxNumGroup =  Math.floor(wordLength * 0.9);\r\n        let numGroup = Math.max(1, entropy * maxNumGroup)\r\n        for (let index = 0; index < numGroup; index++) {\r\n            let groupKeyFrames = [] as KeyFrame[]\r\n            const italicDelta = sampleItalicInterval * ( entropy * 0.5 + Math.random() * 0.1 + 0.4 )\r\n            const weightDelta = sampleWeightInterval * ( entropy * 0.5 + Math.random() * 0.1 + 0.4 )\r\n            const italicRange = [sampleItalicMid - italicDelta, sampleItalicMid + italicDelta]\r\n            const weightRange = [sampleWeightMid - weightDelta * 0.2, sampleWeightMid + weightDelta]\r\n            let fontMid = new FontConfig()\r\n            fontMid.update({italic: sampleItalicMid, weight: sampleWeightMid})\r\n            let fontStart = new FontConfig()\r\n            fontStart.update({italic: italicRange[0], weight:weightRange[0]})\r\n            let fontEnd = new FontConfig()\r\n            fontEnd.update({italic: italicRange[1], weight: weightRange[1]})\r\n            let fontWideMid = new FontConfig()\r\n            fontWideMid.update({italic: sampleItalicMid, weight: weightRange[1]})\r\n            let fontWideStart = new FontConfig()\r\n            fontWideStart.update({ italic: italicRange[0], weight: weightRange[0] })\r\n \r\n            let animation = [] as KeyFrame[]\r\n            let backupFrames = [\r\n                new KeyFrame({font: fontEnd}),\r\n                new KeyFrame({font: fontEnd}),\r\n                new KeyFrame({font: fontWideMid, xoff: -1}),\r\n                new KeyFrame({font: fontWideStart, xoff: -4}),\r\n                // new KeyFrame({font: fontStart }),\r\n                new KeyFrame({font: fontWideMid, yoff: Math.random()>0.5?-2:2}),\r\n                new KeyFrame({font: fontEnd}),\r\n                new KeyFrame({font: fontEnd}),\r\n            ]\r\n            for(let it = 0; it < Math.max(1, Math.floor(Math.random()*3)); it ++) {\r\n                for(let fid = 0; fid < backupFrames.length; fid ++) {\r\n                    if(Math.random() > 0.2) {\r\n                        animation.push(backupFrames[fid])\r\n                    }\r\n                }\r\n            }\r\n            const iter = 10 * speed;\r\n            const al = animation.length;\r\n            const tl = al * iter - 1;\r\n            if(iter == 0) {\r\n                groupKeyFrames.push(...[\r\n                    new KeyFrame({stage: 0}),\r\n                    new KeyFrame({stage: 100}),\r\n                ])\r\n            }\r\n            for (let i = 0; i < iter; i++) {\r\n                animation.forEach((move, idx) => {\r\n                    const stage = Math.ceil((100 / tl) * (idx + i * al));\r\n                    groupKeyFrames.push({...move, stage: stage});\r\n                });\r\n            }\r\n\r\n            keyFrames.push(groupKeyFrames)\r\n        }\r\n        return keyFrames\r\n    }\r\n\r\n\r\n\r\n\r\n    private getSplitKeyframes(wordLength: number, speed: number, entropy: number, alpha: number) {\r\n        let keyFrames = [] as KeyFrame[][];\r\n        let maxNumGroup =  Math.floor(wordLength * 0.9);\r\n        let numGroup = Math.max(minNumGroup, Math.floor(entropy * maxNumGroup))\r\n        for (let index = 0; index < numGroup; index++) {\r\n            const groupKf = [] as KeyFrame[]\r\n            const theta = alpha + index * 2 * Math.PI / numGroup \r\n            const dis = Math.random() * 4 + 2 + entropy * 18\r\n          //  console.log(theta/(2*Math.PI), numGroup,  dis * Math.cos(theta), dis * Math.sin(theta))\r\n            const iter = Math.floor(10 * speed)\r\n            const _move_left = new KeyFrame({ xoff: 3*dis/5 * Math.cos(theta+ Math.PI/7), yoff: 3*dis/5 * Math.sin(theta+Math.PI/7), rotate: 0});\r\n            const _move_right = new KeyFrame({ xoff: 4*dis/5 * Math.cos(theta - Math.PI/8), yoff: 4*dis/5 * Math.sin(theta+Math.PI/8), rotate: 0});\r\n            const _move = new KeyFrame({ xoff: dis * Math.cos(theta), yoff: dis * Math.sin(theta), rotate: 0});\r\n            const _center = new KeyFrame({ xoff: 0, yoff: 0, rotate: 0 });\r\n            const _rotate = new KeyFrame({ rotate: (theta-Math.PI/4)})\r\n            const _neg_rotate = new KeyFrame({ rotate: (-theta+Math.PI/4)})\r\n            const animation = [\r\n                _center,\r\n                // _move_left,\r\n                // _move_right,\r\n                _move,\r\n                _rotate,\r\n                _rotate,\r\n                _neg_rotate,\r\n                _move,\r\n                _move,\r\n                _move,\r\n                _move,\r\n                // _move_right,\r\n                // _move_left,\r\n                _center,\r\n            ]\r\n            const al = animation.length;\r\n            const tl = al * iter - 1;\r\n            if(iter == 0) {\r\n                groupKf.push(...[\r\n                    new KeyFrame({stage: 0}),\r\n                    new KeyFrame({stage: 100}),\r\n                ])\r\n            }\r\n            for (let i = 0; i < iter; i++) {\r\n                animation.forEach((move, idx) => {\r\n                    const stage = Math.ceil((100 / tl) * (idx + i * al));\r\n                    groupKf.push({...move, stage: stage});\r\n                });\r\n            }\r\n            keyFrames.push(groupKf);\r\n        }\r\n        return keyFrames;\r\n    }\r\n    private getDiscoKeyFrames(wordLength: number, speed: number, entropy: number): KeyFrame[][] {\r\n        const keyFrames = [];\r\n        const maxNumGroup =  10;\r\n        const numGroup = Math.min(wordLength, Math.trunc((maxNumGroup - minNumGroup) * entropy + minNumGroup));\r\n        // const minNumStage = 10;\r\n        // const maxNumStage = 100;\r\n        // const numStage = (maxNumStage - minNumStage) * speed + minNumStage; // at least\r\n        // const steps = 100 / numStage;\r\n        for (let index = 0; index < numGroup; index++) {\r\n            const groupKf = [] as KeyFrame[];\r\n            const randXD = Math.round(Math.random()) * 2 - 1;\r\n            const move = new KeyFrame({ xoff: randXD * (  entropy * 3) });\r\n            const center = new KeyFrame({ xoff: 0, yoff: 0 });\r\n            const randY = Math.random() * 2.0;\r\n            const jump = new KeyFrame({yoff: -randY * (speed + entropy + 1)});\r\n            const animation = [\r\n                move,\r\n                center,\r\n                move,\r\n                jump\r\n            ]\r\n            const iter = 10 * speed;\r\n            const al = animation.length;\r\n            const tl = al * iter - 1;\r\n            if(iter == 0) {\r\n                groupKf.push(...[\r\n                    new KeyFrame({stage: 0}),\r\n                    new KeyFrame({stage: 100}),\r\n                ])\r\n            }\r\n            for (let i = 0; i < iter; i++) {\r\n                animation.forEach((move, idx) => {\r\n                    const stage = Math.ceil((100 / tl) * (idx + i * al));\r\n                    groupKf.push({...move, stage: stage});\r\n                });\r\n            }\r\n            // for (let j = 0; j < numStage + 1; j++) {\r\n            //     const stage = Math.trunc(j * steps);\r\n            //     let kf: KeyFrame;\r\n                // if(j % 2 == 0) { \r\n                //     kf = new KeyFrame({xoff: 0, yoff: 0, stage: stage});\r\n                // } else {\r\n                //     const randxd = Math.round(Math.random()) * 2 - 1;\r\n                //     const randyd = Math.round(Math.random()) * 2 - 1;\r\n                //     const randrd = Math.round(Math.random()) * 2 - 1;\r\n                //     const randx = parseFloat((Math.random() + entropy * 3).toFixed(2));\r\n                //     const randy = parseFloat((Math.random() + entropy * 3).toFixed(2));\r\n                //     const randr = parseFloat((Math.random()).toFixed(2));\r\n                //     kf = new KeyFrame({ xoff: randxd * randx, yoff: randyd * randy, rotate: randrd * randr, stage: stage });\r\n                // }\r\n                // 1. left -> left -> jump\r\n                // left\r\n\r\n                // jump\r\n                // groupKf.push(kf);\r\n            // }\r\n            keyFrames.push(groupKf);\r\n        }\r\n        return keyFrames;\r\n    }\r\n}\r\n\r\nlet shuffle = function <T>(array: T[]) {\r\n    let currIdx = array.length, tempVal, randIdx\r\n    while (0 != currIdx) {\r\n        randIdx = Math.floor(Math.random() * currIdx)\r\n        currIdx -= 1\r\n        tempVal = array[currIdx]\r\n        array[currIdx] = array[randIdx]\r\n        array[randIdx] = tempVal\r\n    }\r\n    return array\r\n}\r\n\r\nexport { KeyFrameHandler }","/* eslint-disable */\r\n/**\r\n * doc comment for jump.ts\r\n * @remarks \r\n * It is working in progress. It trys to tune the webgl program more subtlely.\r\n * @packageDocumentation\r\n */\r\n\r\n\r\n// Reads out a .ttf and triangulates the glyphs using OpenType and Earcut.\r\n// Code made By riv -> https://stackoverflow.com/questions/50554803/triangulate-path-data-from-opentype-js-using-earcut/50581183#50581183\r\n// Original here -> https://jsbin.com/gecakub/edit?html,js,output\r\n\r\n// 1. Reads Bezier curves from `.tff` font file using OpenType.js.\r\n// 2. Converts Bezier curves into closed shapes and sort them by descending area.\r\n// 3. Determines the indices for the holes by figuring out which shapes are inside other shapes.\r\n// 4. Send all points to Earcut with the holes indices as a second parameter.\r\n// 5. Uses earcut's result as indices for the geometry.\r\n// 6. Then, render triangles with webGL.\r\n\r\n\r\nimport opentype from \"opentype.js\"\r\nimport earcut from \"earcut\"\r\nimport { createShader, createProgram } from \"./gl-helper\"\r\n// import { polygonCentroid } from \"d3\"\r\nimport { Word } from './types'\r\n\r\ninterface P {\r\n  x: number,\r\n  y: number\r\n}\r\n\r\n\r\nconst FONTURL = \"https://cdnjs.cloudflare.com/ajax/libs/ink/3.1.10/fonts/Roboto/roboto-regular-webfont.ttf\"\r\nlet time: any = null\r\nlet pace = 80.0\r\n\r\nfunction distance(p1: P, p2: P) {\r\n  const dx = p1.x - p2.x,\r\n    dy = p1.y - p2.y\r\n  return Math.sqrt(dx * dx + dy * dy)\r\n}\r\n\r\nfunction lerp(p1: P, p2: P, t: number) {\r\n  return { x: (1 - t) * p1.x + t * p2.x, y: (1 - t) * p1.y + t * p2.y }\r\n}\r\n\r\nfunction cross(p1: P, p2: P) {\r\n  return p1.x * p2.y - p1.y * p2.x\r\n}\r\n\r\n// bezier discretization\r\nconst MAX_BEZIER_STEPS = 10\r\nconst BEZIER_STEP_SIZE = 3.0\r\n// this is for inside checks - doesn't have to be particularly\r\n// small because glyphs have finite resolution\r\nconst EPSILON = 1e-6\r\n\r\nlet gl: any\r\nlet indices: any\r\n// class for converting path commands into point data\r\nclass Polygon {\r\n  public points: Array<P> = []\r\n  public children: Polygon[] = []\r\n  public area: any = 0.0\r\n\r\n  moveTo(p:P) {\r\n    this.points.push(p)\r\n  }\r\n\r\n  lineTo(p:P) {\r\n    this.points.push(p)\r\n  }\r\n  close() {\r\n    let cur = this.points[this.points.length - 1]\r\n    this.points.forEach(next => {\r\n      this.area += 0.5 * cross(cur, next)\r\n      cur = next\r\n    })\r\n  }\r\n  conicTo(p: P, p1: P) {\r\n    const p0 = this.points[this.points.length - 1]\r\n    const dist = distance(p0, p1) + distance(p1, p)\r\n    const steps = Math.max(\r\n      2,\r\n      Math.min(MAX_BEZIER_STEPS, dist / BEZIER_STEP_SIZE)\r\n    )\r\n    for (let i = 1; i <= steps; ++i) {\r\n      const t = i / steps\r\n      this.points.push(lerp(lerp(p0, p1, t), lerp(p1, p, t), t))\r\n    }\r\n  }\r\n  cubicTo(p: P, p1: P, p2: P) {\r\n    const p0 = this.points[this.points.length - 1]\r\n    const dist = distance(p0, p1) + distance(p1, p2) + distance(p2, p)\r\n    const steps = Math.max(\r\n      2,\r\n      Math.min(MAX_BEZIER_STEPS, dist / BEZIER_STEP_SIZE)\r\n    )\r\n    for (let i = 1; i <= steps; ++i) {\r\n      const t = i / steps\r\n      const a = lerp(lerp(p0, p1, t), lerp(p1, p2, t), t)\r\n      const b = lerp(lerp(p1, p2, t), lerp(p2, p, t), t)\r\n      this.points.push(lerp(a, b, t))\r\n    }\r\n  }\r\n\r\n  inside(p: P) {\r\n    let count = 0,\r\n      cur = this.points[this.points.length - 1]\r\n    this.points.forEach(next => {\r\n      const p0 = cur.y < next.y ? cur : next\r\n      const p1 = cur.y < next.y ? next : cur\r\n      if (p0.y < p.y + EPSILON && p1.y > p.y + EPSILON) {\r\n        if ((p1.x - p0.x) * (p.y - p0.y) > (p.x - p0.x) * (p1.y - p0.y)) {\r\n          count += 1\r\n        }\r\n      }\r\n      cur = next\r\n    })\r\n    return count % 2 !== 0\r\n  }\r\n}\r\n\r\nfunction tick(t: number) {\r\n  gl.uniform1f(time, t / pace)\r\n  gl.drawElements(gl.TRIANGLES, indices.length, gl.UNSIGNED_SHORT, 0)\r\n  requestAnimationFrame(tick)\r\n}\r\n\r\nlet getRoots = function (polys: Polygon[]) {\r\n     // classify contours to find holes and their 'parents'\r\n     const root = []\r\n     for (let i = 0; i < polys.length; ++i) {\r\n         let parent = null\r\n         for (let j = i - 1; j >= 0; --j) {\r\n             // a contour is a hole if it is inside its parent and has different winding\r\n             if (\r\n             polys[j].inside(polys[i].points[0]) &&\r\n             polys[i].area * polys[j].area < 0\r\n             ) {\r\n                 parent = polys[j]\r\n                 break\r\n             }\r\n     }\r\n     if (parent) {\r\n             parent.children.push(polys[i])\r\n         } else {\r\n             root.push(polys[i])\r\n         }\r\n     }\r\n     return root\r\n}\r\n\r\nlet getPolys = function (font: opentype.Font, x=0, y=0, s=12, text=\"Hello World\") {\r\n    // create path\r\n    const path = font.getPath(text, x, y, s)\r\n    // create a list of closed contours\r\n    const polys: Polygon[] = []\r\n    path.commands.forEach(({ type, x, y, x1, y1, x2, y2 }: any) => {\r\n    switch (type) {\r\n        case \"M\":\r\n        polys.push(new Polygon())\r\n        polys[polys.length - 1].moveTo({ x, y })\r\n        break\r\n        case \"L\":\r\n        polys[polys.length - 1].moveTo({ x, y })\r\n        break\r\n        case \"C\":\r\n        polys[polys.length - 1].cubicTo(\r\n            { x, y },\r\n            { x: x1, y: y1 },\r\n            { x: x2, y: y2 }\r\n        )\r\n        break\r\n        case \"Q\":\r\n        polys[polys.length - 1].conicTo({ x, y }, { x: x1, y: y1 })\r\n        break\r\n        case \"Z\":\r\n        polys[polys.length - 1].close()\r\n        break\r\n        }\r\n    })\r\n    // sort contours by descending area\r\n    polys.sort((a, b) => Math.abs(b.area) - Math.abs(a.area))\r\n    return polys\r\n}\r\n\r\nlet getVertexData = function (root: Polygon[], polys: Polygon[]) {\r\n    const totalPoints = polys.reduce((sum: number, p: Polygon) => sum + p.points.length, 0)\r\n    const vertexData = new Float32Array(totalPoints * 2)\r\n    let vertexCount = 0\r\n    indices = []\r\n    let process = function(poly: Polygon) {\r\n    // construct input for earcut\r\n        const coords: number[] = []\r\n        const holes: number[] = []\r\n        poly.points.forEach(({ x, y }) => coords.push(x, y))\r\n        poly.children.forEach(child => {\r\n            // children's children are new, separate shapes\r\n            child.children.forEach(process)\r\n            holes.push(coords.length / 2)\r\n            child.points.forEach(({ x, y }) => coords.push(x, y))\r\n        })\r\n        // add vertex data\r\n        vertexData.set(coords, vertexCount * 2)\r\n        // add index data\r\n        earcut(coords, holes).forEach(i => indices.push(i + vertexCount))\r\n        vertexCount += coords.length / 2\r\n    }\r\n    root.forEach(process)\r\n    console.log(vertexData)\r\n    return [vertexData, indices]\r\n}\r\n\r\nlet draw = function (font: opentype.Font, words: Word[] = [], statement: string=defaultvs) {\r\n    let canvas = document.getElementById(\"emordle-canvas\") as HTMLCanvasElement\r\n    const width = canvas.width\r\n    const height = canvas.height\r\n    let polyAll: Polygon[] = []\r\n    for (let word of words) {\r\n        let polys = getPolys(font, word.x! - word.width! / 2, word.y, word.size, word.text)\r\n        polyAll = polyAll.concat(polys)\r\n    }\r\n    let root = getRoots(polyAll)\r\n    let [vertexData, indices] = getVertexData(root, polyAll)\r\n    drawOnCanvas(vertexData, indices, statement)\r\n}\r\n\r\nconst defaultvs = ` pos.y += pow(sin( (pos.x) / 500.+ uTime *.02),2.) * 20.;\r\npos.x += sin( pos.y/ 100. + uTime *.8) * .5;\r\n`\r\n\r\nconst staticvs = ` pos.y = pos.y;\r\npos.x = pos.x;\r\n`\r\n\r\nlet vsGenerator = function (speed: number, entropy: number) {\r\n  if (speed == 0) return staticvs\r\n  const waveletNum = Math.max(1, Math.floor(entropy * 10))\r\n  const timeGran = (0.01 + speed * 0.3) \r\n  const yAmplitude = 15.1 + 9.9 * entropy\r\n  const yExtent = 10.1 + (1.05 - entropy) * 359.9\r\n  const xExtent = 50.1 + (1.05 - entropy) * 150.1\r\n  const xAmplitude = 0.02 + 0.08 * entropy\r\n  let xPosStr = `sin( pos.y/${xExtent} + uTime * ${timeGran}) * ${xAmplitude}`\r\n  let yPosStr = `pow(sin( (pos.x) / ${yExtent} + uTime * ${timeGran}), 2.) * ${yAmplitude}`\r\n  let result = `\r\n  pos.x += ${xPosStr};\r\n  pos.y += ${yPosStr};\r\n  `\r\n  console.log(result)\r\n  return result\r\n  //return defaultvs\r\n}\r\n\r\nlet drawOnCanvas = function (vertexData: Float32Array, indices: Uint16Array, statement: string=defaultvs) {\r\n    const canvas = document.getElementById(\"emordle-canvas\") as HTMLCanvasElement\r\n    gl = canvas.getContext(\"webgl\")\r\n    const width = canvas.width\r\n    const height = canvas.height\r\n    gl.viewport(0, 0, width, height)\r\n    const vs = createShader(gl, gl.VERTEX_SHADER, `\r\n      precision mediump float;\r\n      uniform vec2 uScale;\r\n      uniform vec2 uOffset;\r\n      uniform float uTime;\r\n      attribute vec2 position;\r\n      varying vec4 fragColor;\r\n      void main() {\r\n      vec2 pos = position;\r\n      ${statement}\r\n      gl_Position = vec4(pos * uScale + uOffset, 0.0, 1.0);\r\n      fragColor = vec4(0., 0., 0., 1.);// vec4(sin(uTime*.5)*.5+.5, cos(uTime*.2)*.5+.5, 0., 1. ); // colorful\r\n    }`)\r\n    const ps = createShader(gl, gl.FRAGMENT_SHADER,\r\n        `precision mediump float;\r\n        uniform vec4 uColor;\r\n        uniform vec2 u_resolution;\r\n        varying vec4 fragColor;\r\n        void main() {\r\n        gl_FragColor = uColor;\r\n        vec2 st = gl_FragCoord.xy / u_resolution;\r\n        gl_FragColor = fragColor;\r\n        }`)\r\n    const prog = createProgram(gl, vs, ps)\r\n    gl.bindAttribLocation(prog, 0, \"position\")\r\n    const [uScale, uOffset, uColor, uTime, u_resolutionLoc, fragColor] = [\r\n    \"uScale\",\r\n    \"uOffset\",\r\n    \"uColor\",\r\n    \"uTime\",\r\n    \"u_resolution\",\r\n    \"fragColor\"\r\n    ].map(name => gl.getUniformLocation(prog, name))\r\n    time = uTime\r\n    gl.useProgram(prog)\r\n    gl.uniform1f(uTime, 0)\r\n    gl.uniform2fv(uScale, [2.0 / width, -2.0 / height])\r\n    gl.uniform2fv(uOffset, [0.0, 0.0])\r\n    gl.uniform4fv(uColor, [0.0, 0.0, 0.0, 1.0])\r\n    gl.uniform4fv(fragColor, [0.0, 0.0, 0.0, 1.0])\r\n    gl.uniform2f(u_resolutionLoc, gl.canvas.width, gl.canvas.height)\r\n    gl.clearColor(1.0, 1.0, 1.0, 1.0)\r\n    gl.clear(gl.COLOR_BUFFER_BIT)\r\n    const vertBuffer = gl.createBuffer()\r\n    gl.bindBuffer(gl.ARRAY_BUFFER, vertBuffer)\r\n    gl.bufferData(gl.ARRAY_BUFFER, vertexData, gl.STATIC_DRAW)\r\n    const indxBuffer = gl.createBuffer()\r\n    const indexData = new Uint16Array(indices)\r\n    gl.bindBuffer(gl.ELEMENT_ARRAY_BUFFER, indxBuffer)\r\n    gl.bufferData(gl.ELEMENT_ARRAY_BUFFER, indexData, gl.STATIC_DRAW)\r\n    gl.enableVertexAttribArray(0)\r\n    gl.vertexAttribPointer(0, 2, gl.FLOAT, true, 8, 0)\r\n    gl.drawElements(gl.TRIANGLES, indices.length, gl.UNSIGNED_SHORT, 0)\r\n    gl.flush()\r\n    console.log('Finish')\r\n    tick(Date.now())\r\n}\r\n\r\nlet onloadedFont = function(err: any, font: opentype.Font | undefined) {\r\n    if (err) {\r\n        alert(\"Font could not be loaded: \" + err)\r\n    } else if (font) {\r\n        console.log(font)\r\n        draw(font)\r\n    }\r\n}\r\n\r\nexport let test = function (fontUrl=FONTURL) {\r\n    opentype.load(\r\n        fontUrl,\r\n        onloadedFont\r\n      )    \r\n}\r\ninterface WavingParam {\r\n  words: Word[],\r\n  fontUrl: string,\r\n  speed: number,\r\n  entropy: number\r\n}\r\nexport let jumpingWordle = function ({words=[], fontUrl=FONTURL, speed=0.5, entropy=0.5 }: WavingParam) {\r\n    opentype.load(\r\n        fontUrl,\r\n        function(err, fontMeta: opentype.Font | undefined) {\r\n            if (err) {\r\n                console.log(fontUrl)\r\n                alert(\"Font could not be loaded: \" + err)\r\n            } else if (fontMeta) {\r\n                let statement = vsGenerator(speed, entropy)\r\n                draw(fontMeta, words, statement)\r\n            }\r\n        }\r\n    )\r\n}","/* eslint-disable */\r\n/**\r\n * doc comment for animator.ts\r\n * @remarks \r\n * the latest design for animation unit\r\n * the logic is to use Animator to control GroupManager\r\n * @packageDocumentation\r\n */\r\nimport * as d3Timer from 'd3-timer'\r\nimport * as d3Ease from 'd3-ease'\r\nimport * as d3Itpl from 'd3-interpolate'\r\nimport { PlotHandler } from './plot'\r\nimport * as Gif from \"@/assets/lib/gif/gif\"\r\nimport { kmeans } from '@/assets/lib/kmeans'\r\nimport { FontConfig } from \"@/assets/variable-font\"\r\nimport * as Manual from \"@/assets/manual\"\r\nimport { KeyframeConfig, GroupingMode, Word, Mode, MetaConfig, GroupManagerConfig, AnimatorPlayParams} from \"@/assets/types\"\r\nimport { KeyFrameHandler } from './keyframe-handler'\r\nimport { Meta } from './animation'\r\nimport { jumpingWordle } from \"@/assets/jump\"\r\n\r\nclass KeyFrame implements KeyframeConfig {\r\n    public x: number = 0\r\n    public y: number = 0\r\n    public xoff: number = 0\r\n    public yoff: number = 0\r\n    public rotate: number = 0\r\n    public scale: number = 1\r\n    public opacity: number = 1\r\n    public color: string = 'black'\r\n    public stage: number = 0\r\n    public duration: number = 10\r\n    public font: FontConfig = new FontConfig() \r\n    constructor(configs: Partial<KeyframeConfig>) {\r\n        Object.assign(this, configs);\r\n    }\r\n}\r\n\r\nclass GroupManager implements GroupManagerConfig {\r\n    public order: number = 0;\r\n    public delay: number = 0;\r\n    public duration: number = 2000;\r\n    public ease: (a: number) => (number) = (a:number) => a; //d3Ease.easeCubic\r\n    public words: Array<MetaConfig> = [];\r\n    public origin: Array<MetaConfig> = [];\r\n    public keyFrames: Array<KeyFrame> = [];\r\n    public frameCounter: number = 0;\r\n    public font: FontConfig = new FontConfig();\r\n    constructor(configs: Partial<GroupManager>) {\r\n        Object.assign(this, configs);\r\n    }\r\n\r\n    public updateWord(ckf: KeyFrame, nkf: KeyFrame, frameAt: number, phase: number) {\r\n        this.font.setValWithRatio('width', 1);\r\n        // this.font.setValWithRatio('italic', Math.abs(Math.sin(Date.now()/1000)));\r\n        // this.font.setValWithRatio('weight', phase);\r\n        const color = d3Itpl.interpolateHcl(ckf.color, nkf.color)(frameAt);\r\n        this.font.update({\r\n            italic: (nkf.font.italic - ckf.font.italic) * this.ease(frameAt),\r\n            weight: (nkf.font.weight - ckf.font.weight) * this.ease(frameAt),\r\n        })\r\n        const fontString = this.font.getCss();\r\n        // assign by value  \r\n        this.words.forEach((d) => {\r\n            const xoff = (nkf.xoff - ckf.xoff) * this.ease(frameAt);\r\n            const yoff = (nkf.yoff - ckf.yoff) * this.ease(frameAt);\r\n            const scale = (nkf.scale - ckf.scale) * this.ease(frameAt);\r\n            const rotate = (nkf.rotate - ckf.rotate) * this.ease(frameAt);\r\n            d.x = d.x! + xoff;\r\n            d.y = d.y! + yoff;\r\n            d.rotate = rotate;\r\n            d.size = d.trues! * (1 + scale);\r\n            d.color = color;\r\n            d.fontString = fontString;\r\n        });\r\n    }\r\n\r\n    public setFrameCounter(fc: number) {\r\n        this.frameCounter = fc;\r\n    }\r\n\r\n    public reset() {\r\n        this.words = this.origin.map(a => Object.assign({}, a));\r\n        this.frameCounter = 0;\r\n    }\r\n}\r\n\r\n/** obatin animating frames and control the groups */\r\nclass WordleAnimator {\r\n    public data: Array<Word> = [];\r\n    public timer?: d3Timer.Timer | undefined;\r\n    readonly words: Array<MetaConfig> = new Array();\r\n    public duration: number = 30000;\r\n    public groupManagers: Array<GroupManager> = [];\r\n    public plotHandler?: PlotHandler;\r\n    public mode: Mode = Mode.dance;\r\n    public extent: number = 0.5;\r\n    public speed: number = 0.5;\r\n    public entropy: number = 0.5;\r\n    public gif: any;\r\n    public wordMap: Map<string, number> = new Map()\r\n    constructor(configs: Partial<WordleAnimator>) {\r\n        Object.assign(this, configs);\r\n        this.data.forEach((word: Word, idx: number) => {\r\n            this.wordMap.set(word.text!, idx)\r\n            this.words.push(new Meta(word, this.plotHandler!.width, this.plotHandler!.height))\r\n        })\r\n    }\r\n\r\n    public createManagers(numGroups: number, field: Partial<GroupManager>={}) {\r\n        this.groupManagers = new Array(numGroups);\r\n        for(var i = 0; i < numGroups; ++i) {\r\n            this.groupManagers[i] = new GroupManager(field);\r\n        }\r\n    }\r\n\r\n    public assignKeyFrame(keyFrames: KeyFrame[][]) {\r\n        this.groupManagers.forEach((gm, idx) => {\r\n            gm.keyFrames = keyFrames[idx];\r\n        });\r\n    }\r\n\r\n    /** Devide the words into groups\r\n     *  1. create groupNum group managers\r\n     *  2. assign words to each group manager according to the mode\r\n     */\r\n    public divideGroup(mode: GroupingMode, centers: [number, number][]=[]) {\r\n        let numGroup = centers.length == 0 ? this.groupManagers.length : centers.length;\r\n        let numWordsPerGroup = Math.ceil(this.words.length / numGroup);\r\n        let assignedWords = [] as MetaConfig[];\r\n        if (mode !== GroupingMode.xy) {\r\n            if (mode === GroupingMode.random) {\r\n                assignedWords = shuffle(this.words);\r\n            } else if (mode === GroupingMode.x) {\r\n                assignedWords = this.words.sort((a, b) => a.x! - b.x!);\r\n            } else if (mode == GroupingMode.y) {\r\n                assignedWords = this.words.sort((a, b) => a.y! - b.y!);\r\n            }\r\n            this.groupManagers.forEach((group, i) => {\r\n                const startIdx = numWordsPerGroup * i;\r\n                const endIdx = startIdx + numWordsPerGroup;\r\n                const words = assignedWords.slice(startIdx, endIdx);\r\n                group.origin = words.map(x => Object.assign({}, x));\r\n                group.words = words.map(x => Object.assign({}, x));\r\n            })\r\n        }\r\n        else {  // divide by xy\r\n            let positions = this.words.map((word: MetaConfig) => [word.x, word.y]);\r\n            let alias = centers.length == 0? \"kmeans\": centers \r\n            let result = kmeans(positions, numGroup, alias);\r\n            let wordBags = getMatrix(numGroup, 0) as Array<Array<MetaConfig>>;\r\n            result.indexes.forEach((d: number, idx: number) => {\r\n                wordBags[d].push(this.words[idx]);\r\n            });\r\n            this.groupManagers.forEach((group, idx) => {\r\n                const words = wordBags[idx];\r\n                group.origin = words.map(x => Object.assign({}, x));\r\n                group.words = words.map(x => Object.assign({}, x));\r\n            });\r\n        }\r\n    }\r\n\r\n    public reset() {\r\n        this.groupManagers.forEach(gm => {\r\n            gm.words = gm.origin.map((v) => Object.assign({}, v));\r\n            gm.frameCounter = 0;\r\n        })\r\n    }\r\n\r\n    public update(field: string, value: any) {\r\n        if (field === 'duration') this.duration = (value as number)\r\n        if (field === 'mode') this.mode = (value as Mode)\r\n    }\r\n\r\n    /** Play the animated wordle.\r\n     * @param {boolean} gifFlag whether to produce Gif\r\n     * 1. get keyframes with given extent, speed, entropy\r\n     *  - extent - extent at which\r\n     */\r\n    public play({gifFlag = false, replay = false} : AnimatorPlayParams = {}) {\r\n        let mode = this.mode\r\n        let svgFlag = mode !== Mode.wave\r\n        this.reset()\r\n        if (mode === Mode.wave) this.playWaving({gifFlag, replay})\r\n        if (mode === Mode.swing) this.playSwinging({gifFlag, replay})\r\n        if (mode === Mode.dance) this.playDancing({gifFlag, replay})\r\n        if (mode === Mode.split) this.playSplitting({gifFlag, replay})\r\n        this.plotHandler!.svg.style('display', svgFlag? '': 'none')\r\n        this.plotHandler!.canvas!.style.display = svgFlag? 'none': ''\r\n    }\r\n\r\n    public playWaving({gifFlag = false, replay = false} : AnimatorPlayParams = {}) {\r\n        let data = this.data.map(v => Object.assign({}, v))\r\n        jumpingWordle({\r\n            words: data,\r\n            entropy: this.entropy,\r\n            speed: this.speed,\r\n            fontUrl: './font/arial.ttf'\r\n        })\r\n    }\r\n\r\n    public playSwinging({gifFlag = false, replay = false} : AnimatorPlayParams = {}) {\r\n        if (!replay) {\r\n            this.plotHandler?.plotOnSvg(this.data);\r\n            const keyFrameHandler = new KeyFrameHandler();\r\n            const wordLength = this.words.length;\r\n            const keyFrames = keyFrameHandler.getKeyFrames(Mode.swing, wordLength, this.speed, this.entropy);\r\n            const numGroups = keyFrames.length;\r\n            const divideMode = this.entropy > 0.5? GroupingMode.random : GroupingMode.y\r\n            this.createManagers(numGroups);\r\n            this.assignKeyFrame(keyFrames);\r\n            this.divideGroup(divideMode);\r\n        } else {\r\n            this.reset();\r\n        }  \r\n        this.startPlay(gifFlag, replay)      \r\n    }\r\n\r\n    public playSplitting({gifFlag = false, replay = false} : AnimatorPlayParams = {}) {\r\n        if (!replay) {\r\n            this.plotHandler?.plotOnSvg(this.data);\r\n            const keyFrameHandler =  new KeyFrameHandler();\r\n            const wordLength = this.words.length;\r\n            let centers = [] as Array<[number, number]>\r\n            let a = this.plotHandler!.width / 4, b = this.plotHandler!.height / 4\r\n            let alpha = Math.random() * Math.PI/4\r\n            const keyFrames = keyFrameHandler.getKeyFrames(Mode.split, wordLength, this.speed, this.entropy, alpha);\r\n            const numGroups = keyFrames.length;\r\n            for (let idx = 0; idx < numGroups; idx ++) {\r\n                let theta = idx * 2 * Math.PI / numGroups + alpha\r\n                let x = a * Math.cos(theta)\r\n                let y = b * Math.sin(theta)\r\n                centers.push([x, y])\r\n            }\r\n            this.createManagers(numGroups, {ease: d3Ease.easeExp});\r\n            this.assignKeyFrame(keyFrames);\r\n            this.divideGroup(GroupingMode.xy, centers);\r\n        } else {\r\n            this.reset();\r\n        }\r\n        this.startPlay(gifFlag, replay)\r\n    }\r\n\r\n\r\n    public playDancing({gifFlag = false, replay = false} : AnimatorPlayParams = {}) {\r\n        if (!replay) {\r\n            this.plotHandler?.plotOnSvg(this.data);\r\n            const keyFrameHandler = new KeyFrameHandler();\r\n            const wordLength = this.words.length;\r\n            const keyFrames = keyFrameHandler.getKeyFrames(Mode.dance, wordLength, this.extent , this.speed, this.entropy);\r\n            const numGroups = keyFrames.length;\r\n            const divideMode = getDivideMode();\r\n            this.createManagers(numGroups);\r\n            this.assignKeyFrame(keyFrames);\r\n            this.divideGroup(divideMode);\r\n        } else {\r\n            this.reset();\r\n        }  \r\n        this.startPlay(gifFlag, replay)      \r\n    }\r\n    /** Core function to play the animation according to the keyframes\r\n     *\r\n     * @param gifFlag \r\n     * @param replay \r\n     */\r\n    public startPlay(gifFlag = false, replay = false) {\r\n        const gms = this.groupManagers;\r\n        this.timer?.stop();\r\n        this.timer = d3Timer.timer((elapsed) => {\r\n            if (elapsed < this.duration) {      \r\n                let totalWords: Array<Word> = new Array<Word>(this.words.length);\r\n                gms.forEach((gm, _) => { \r\n                    let fc = gm.frameCounter;\r\n                    const keyFrames = gm.keyFrames;\r\n                    const ckf = keyFrames[fc];\r\n                    const nkf = keyFrames[fc + 1];\r\n                    const cfa = nkf.stage / 100 * this.duration;\r\n                    if( elapsed >= cfa ) {\r\n                        gm.setFrameCounter(fc + 1);\r\n                    }\r\n                    const fs = ckf.stage / 100 * this.duration; \r\n                    const frameAt = (elapsed - fs) / (cfa - fs);\r\n                    const phase = elapsed / gm.duration;\r\n                    gm.updateWord(ckf, nkf, frameAt, phase);\r\n                    gm.words.forEach((word, _) => {\r\n                        totalWords[this.wordMap.get(word.text!)!] = word\r\n                    })\r\n                })\r\n                this.plotHandler?.updateOnSvg(totalWords);\r\n                if (gifFlag) {\r\n                    this.gif.addFrame(this.plotHandler?.canvas, { copy: true, delay: this.duration / 256 });\r\n                }\r\n            }\r\n            else {\r\n                this.timer?.stop()\r\n                if (gifFlag) {\r\n                    this.gif.render()\r\n                }\r\n                this.play({gifFlag: gifFlag, replay: true});\r\n            }\r\n        }, 10)\r\n    }\r\n\r\n    private getTotalWords() {\r\n        let res = [] as Array<Word>;\r\n        this.groupManagers.forEach((group: GroupManager, idx: number) => {\r\n            res = res.concat(group.words)\r\n        })\r\n        return res\r\n    }\r\n\r\n    public stop() {\r\n        this.timer?.stop()\r\n    }\r\n    /**Generate Gif for a round\r\n     * Reference: https://github.com/jnordberg/gif.js\r\n    @param quality the sampling rate\r\n    */\r\n    public createGif(quality: number = 5) {\r\n        this.gif = new Gif({\r\n            quality: quality\r\n        })\r\n        let param = getKeyFrames();\r\n        this.gif.on('finished', function (blob: any) {\r\n            let wlink = document.createElement('a')\r\n            wlink.setAttribute('target', '_blank')\r\n            wlink.setAttribute('href', URL.createObjectURL(blob))\r\n            wlink.setAttribute('download', \"animation.gif\")\r\n            wlink.addEventListener('click', function () {\r\n                this.remove()\r\n            })\r\n            wlink.click()\r\n\r\n            let plink = document.createElement('a')\r\n            plink.setAttribute('target', '_blank')\r\n            plink.setAttribute('href', \"data:text/json;charset=utf-8,\" + encodeURIComponent(JSON.stringify(param)))\r\n            plink.setAttribute('download', \"param.json\")\r\n            plink.addEventListener('click', function () {\r\n                this.remove()\r\n            })\r\n            plink.click()\r\n        })\r\n        return this\r\n    }\r\n\r\n    /** Group the words according to position.\r\n     */\r\n    private assignWords(groupNum: number, numWordsPerGroup: number, wordsCopy: MetaConfig[]) {\r\n        for (let i = 0; i < groupNum; i++) {\r\n            let startIdx = numWordsPerGroup * i;\r\n            let endIdx = startIdx + numWordsPerGroup;\r\n            this.groupManagers[i].words = wordsCopy.slice(startIdx, endIdx);\r\n        }\r\n    }\r\n\r\n}\r\n\r\nfunction getDivideMode() {\r\n    return GroupingMode.x;\r\n}\r\n\r\n// separate key frame getter logic from wordle class\r\nfunction getKeyFrames() {\r\n    // logic to get keyframes, hard coded for now\r\n    return [Manual.smallShake(), Manual.colorTransition(), Manual.shakeNRotate()];\r\n}\r\n\r\n\r\nlet shuffle = function <T>(array: T[]) {\r\n    let currIdx = array.length, tempVal, randIdx\r\n    while (0 != currIdx) {\r\n        randIdx = Math.floor(Math.random() * currIdx)\r\n        currIdx -= 1\r\n        tempVal = array[currIdx]\r\n        array[currIdx] = array[randIdx]\r\n        array[randIdx] = tempVal\r\n    }\r\n    return array\r\n}\r\n\r\nlet getMatrix = function <T>(row: number, col: number) {\r\n    let matrix = [] as Array<Array<T>>\r\n    for (let i = 0; i < row; i++) {\r\n        if (col !== 0) {\r\n            matrix.push(new Array(col).fill(0))\r\n        }\r\n        else {\r\n            let slot = [] as Array<T>\r\n            matrix.push(slot)\r\n        }\r\n    }\r\n    return matrix\r\n}\r\n\r\nexport { WordleAnimator, KeyFrame, GroupManager }"],"sourceRoot":""}